# PyGame-CEによるインタラクティブ表現入門その2：PyGame-CEの基本とアニメーション

```{note}
この回のゴール:
1. pygame-ceでさまざまな図形を描ける
2. かんたんなアニメーションを描ける
```

## PyGame-CEプログラムの構成を学ぶ

前回の教材で以下のようなプログラムを作成した．このプログラムの内容を理解していこう．

```python
import pygame

# 初期化
pygame.init()

# 400ピクセル×400ピクセルのウィンドウをつくる
WIDTH, HEIGHT = 400, 400
screen = pygame.display.set_mode((WIDTH, HEIGHT))
pygame.display.set_caption("PyGame-CE Program 1: basic drawing")

clock = pygame.time.Clock()
running = True

# メインループ
while running:
    # 1. イベント処理
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            running = False  # ウィンドウ右上の×で終了

    # 2. 背景を塗る
    screen.fill((220, 220, 220))  # R,G,B [0-255]

    # 3. 図形を描く
    # 青い円 (x=200, y=200, 半径30)
    pygame.draw.circle(screen, (0, 0, 255), (200, 200), 30)

    # 赤い四角形 (x=50, y=50, 幅80, 高さ80)
    pygame.draw.rect(screen, (255, 0, 0), (50, 50, 80, 80))

    # 4. 画面を更新
    pygame.display.flip()

    # 5. フレームレート制御 (1秒あたり60フレーム程度)
    clock.tick(60)

# 終了処理
pygame.quit()
```

ポイント:
- `while running:` の部分は、プログラムが動いている間くり返し処理を行う**メインループ**である。
この中でイベント（入力）を処理していることから、**イベントループ**と呼ばれることもある。
- `if event.type == pygame.QUIT:` は「ウィンドウを閉じる操作が来たらメインループから抜ける」という分岐である．メインループが`while running:`で回っているので，`running = False`とすればメインループから抜けることになる．
- `screen.fill(...)` は画面全体を灰色に塗りつぶしている．つまり画面の背景色を設定している．
- `pygame.draw.circle(...)` は円，`pygame.draw.rect(...)` は四角形を描いている．

メインループの中で円と四角形を描画しているので，つまりこのプログラムは「画面を一度灰色に塗りつぶしてから，円と四角形を描画する」という操作を何度も繰り返し行っている．しかし円と四角形を描画する位置が変わらないので，事実上，静止画を表示したのと同じことになっている．

## かんたんなアニメーション

円と四角形を動かしてみよう．つまり，円と四角形を描画する位置をメインループの中で変えてみよう．

```python
x1 = 200
x2 = 50
# メインループ
while running:
    # 1. イベント処理
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            running = False  # ウィンドウ右上の×で終了

    # 2. 背景を塗る
    screen.fill((220, 220, 220))  # R,G,B [0-255]

    # 3. 図形を描く
    # 青い円 (x=x1, y=200, 半径30)
    pygame.draw.circle(screen, (0, 0, 255), (x1, 200), 30)

    # 赤い四角形 (x=x2, y=50, 幅80, 高さ80)
    pygame.draw.rect(screen, (255, 0, 0), (x2, 50, x2+30, 80))
```


## 3. 座標系について

- 画面の左上が (0, 0)
- 右方向に行くほど x が増える
- 下方向に行くほど y が増える

これは，今後「重力が下向き（+y方向）」といった物理シミュレーションを行うときにもそのまま使います。
（つまり y方向の正の向きが「下」というルールです。）

```{admonition} 例
(x, y) = (200, 200) は，画面のほぼ真ん中あたり。
半径30の円をそこに置いたのが上のコードの `pygame.draw.circle(...)` です。
```


## 4. おまけ: マウスの位置に円を描く

「インタラクティブだ」と感じてもらうために，マウスに追随する円も試してみましょう。
下のように，描画のところだけ少し変えてみてください。

```python
    # 2. 背景を塗る
    screen.fill((255, 255, 255))

    # 3. マウス位置を取得
    mx, my = pygame.mouse.get_pos()

    # 4. マウスのところに青い円
    pygame.draw.circle(screen, (0, 0, 255), (mx, my), 20)
```

動かしてみると，マウスポインタを追いかける青い円が表示されます。  
これは「リアルタイム入力 → 描画」というゲーム・インタラクティブアートの基本になります。


## 5. 課題（LMS提出）

```{admonition} 課題
1. 背景色・円・四角形の色やサイズ・位置を自由に変更し，自分なりの画面をデザインする。
2. プログラムを実行して，ウィンドウが開いている状態のスクリーンショットを撮る。
3. スクリーンショットをLMSに提出する。

注意：
- ウィンドウを閉じる前に撮影してください。
- これ以降の回の評価のベースになるので，このプログラム (`lesson05.py`) は消さずにとっておいてください。
```


## 6. ライセンス

```{note}
このページの本文と図版は CC BY-NC-SA 4.0 とします。  
サンプルコードは MIT License とします。  
一部の学生作品のスクリーンショットなどはこの限りではありません。  
提出物（あなた自身のコードやスクリーンショット）は，ポートフォリオや就職活動で自由に使ってよいものとします。
```
