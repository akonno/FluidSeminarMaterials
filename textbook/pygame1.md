# pygame-ceでの描画とアニメーション

```{note}
この回のゴール:
1. pygame-ceでウィンドウを開ける
2. 背景色と図形（円・四角形）を描ける
3. 座標系（原点・x・y）を理解する
4. スクリーンショットをLMSに提出できる
```

## 🔷 PyGameとPyGame-CEについて

**PyGame**（パイゲーム） は、Pythonというプログラミング言語でゲームやアニメーションを作るためのライブラリである。
ウィンドウを開いて図形を描いたり、マウスやキーボードの操作に反応させたり、音を鳴らしたりすることができる。
**PyGame-CE**（Community Edition） はPyGameを継承して改良を加えたコミュニティ版であり、最新のPython環境で安定して動作し、新しい機能も追加されている。
教育や創作の場で使いやすく、現在も開発が続けられている実用的な基盤である。

PyGame-CEを使うと、プログラムで動く世界を作ることができる。
画面上で形を動かしたり、操作に反応させたりしながら、動きの仕組みを直感的に学べる。
この教材ではPyGame-CEを使い、いくつかの演習を通じて、最終的に自分だけのインタラクティブアートや簡単なゲームを作ることを目指す。この教材に書かれている範囲を超えて自由に試し、動かしながら、プログラムで世界を作る感覚を楽しんでほしい。


## 環境セットアップ (Windows 11 + Miniforge)

Miniforge Promptを開き，EXERCISE環境に入って，以下のコマンドを実行する．PyGame-CEは`conda`ではインストールできないので（2025年11月現在），`pip`を用いてインストールする．

```powershell
conda activate EXERCISE     # EXERCISE環境に入る
python -m pip install --upgrade pip
python -m pip install pygame-ce
```

環境が正しくできたか，次のコマンドを実行して確認せよ．

```powershell
python -c "import sys, pygame; print(sys.version); print(pygame.version.ver)"
```

- Pythonのバージョンと pygame-ce のバージョンが表示されれば，適切にインストールできている．

## JupyterLabをエディタとして使う

### エディタ（テキストエディタ）とは

**エディタ（テキストエディタ）** とは、文字だけで書かれた文章やプログラムのコードを編集するためのソフトウェアである。
文書作成ソフトのような装飾機能はなく、文字を入力し、修正し、必要に応じて保存することに特化している。
プログラミングでは、エディタを使ってコードを記述し、それを実行して結果を確かめながら、少しずつ内容を整えていく。
コードがファイルとして保存されていれば、あとから再利用や改良もできる。

エディタは「プログラムを書くためのノート」であり、**考えを形にする入口**であるといえる。
どの言語を使う場合でも、エディタを自在に扱えることは、プログラミングの第一歩である。

現在、プログラミングには専用のエディタを用いるのが一般的である。
その中でも **Visual Studio Code（VS Code）** は最も広く使われており、多くの言語に対応し、拡張機能やデバッグ支援などが充実している。
本格的なプログラミングを行う際には、VS Codeの利用を推奨する。

ただし、本教材では環境構築の確実さと手軽さを重視し、すでに導入済みの **JupyterLab** に含まれるテキストエディタを用いる。
JupyterLabのエディタは軽量で安定しており、Pythonのコードを編集・保存し、同じ環境のターミナルからそのまま実行できる。
これにより、追加の設定を行うことなく、すぐにプログラミングの学習を始めることができる。

### JupyterLabのエディタとしての使い方

今回はJupyterLabをエディタとして使い，それとは別にMiniforge PromptでPythonプログラムを実行する．そのため，先ほど起動したMiniforge Promptとは別にもう一つ，Miniforge Promptを起動して，JupyterLabを起動する．手順は以前の教材で説明しているので，ここでは省略する．

```{figure} ./images/editor01.drawio.png
JupyterLabの画面．Pythonファイルを置きたい場所まで移動し（①），下段の「その他」のところにある「Pythonファイル」（②）をクリックする．
またはメニューからファイル --> 新規 --> Pythonファイルを選択しても良い．
```

```{figure} ./images/media/jupyterlab-editor.drawio.png
untitled1.pyというファイルが作られ，その画面が開く．ファイル名を変えたいときは，ファイルブラウザーのファイル名を右クリックし「名前を変更」を選ぶ．前の教材で説明したとおりである．
```

```{figure } ./images/media/jupyterlab-editor6.png
実行したいプログラムを書く．
```

```{figure} ./images/editor04.drawio.png
JupyterLab Notebookのセルとは異なり，ファイルを保存しないと実行できない．メニューからファイル --> Python Fileを保存 を選び，保存する．
```

Miniforge Promptからいま書いたプログラムを実行してみよ．

```{powershell}
python pytest1.py
```

**そのファイルがある場所**で実行すること．`dir`コマンドでいまいるディレクトリにあるファイルを確認し，実行すること．（ディレクトリの移動には`cd`コマンドを用いる．詳細は適宜調べること．）そのファイルがある場所で実行しなかった場合やファイル名を間違えた場合には，`[Error 2] No such file or directory`というエラーが表示される．

## PyGame-CEによる最初のプログラム（ウィンドウを開く・図形を描く）

新しいPythonファイルを作り，そこに以下のプログラムを保存して，実行してください。

```python
import pygame

# 初期化
pygame.init()

# ウィンドウをつくる
WIDTH, HEIGHT = 400, 400
screen = pygame.display.set_mode((WIDTH, HEIGHT))
pygame.display.set_caption("Lesson 5: basic drawing")

clock = pygame.time.Clock()
running = True

# メインループ
while running:
    # 1. イベント処理
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            running = False  # ウィンドウ右上の×で終了

    # 2. 背景を塗る
    screen.fill((220, 220, 220))  # R,G,B [0-255]

    # 3. 図形を描く
    # 青い円 (x=200, y=200, 半径30)
    pygame.draw.circle(screen, (0, 0, 255), (200, 200), 30)

    # 赤い四角形 (x=50, y=50, 幅80, 高さ80)
    pygame.draw.rect(screen, (255, 0, 0), (50, 50, 80, 80))

    # 4. 画面を更新
    pygame.display.flip()

    # 5. フレームレート制御 (1秒あたり60フレーム程度)
    clock.tick(60)

# 終了処理
pygame.quit()
```

ポイント:
- `while running:` がゲーム本体の「ずっと繰り返す部分」です。
- `if event.type == pygame.QUIT:` は「ウィンドウを閉じる操作が来たら終わる」という分岐です。
- `screen.fill(...)` は背景色，相当する関数はp5.jsでいう `background(...)` と同じ考え方です。
- `pygame.draw.circle(...)` は円，`pygame.draw.rect(...)` は四角形を描きます。


## 3. 座標系について

- 画面の左上が (0, 0)
- 右方向に行くほど x が増える
- 下方向に行くほど y が増える

これは，今後「重力が下向き（+y方向）」といった物理シミュレーションを行うときにもそのまま使います。
（つまり y方向の正の向きが「下」というルールです。）

```{admonition} 例
(x, y) = (200, 200) は，画面のほぼ真ん中あたり。
半径30の円をそこに置いたのが上のコードの `pygame.draw.circle(...)` です。
```


## 4. おまけ: マウスの位置に円を描く

「インタラクティブだ」と感じてもらうために，マウスに追随する円も試してみましょう。
下のように，描画のところだけ少し変えてみてください。

```python
    # 2. 背景を塗る
    screen.fill((255, 255, 255))

    # 3. マウス位置を取得
    mx, my = pygame.mouse.get_pos()

    # 4. マウスのところに青い円
    pygame.draw.circle(screen, (0, 0, 255), (mx, my), 20)
```

動かしてみると，マウスポインタを追いかける青い円が表示されます。  
これは「リアルタイム入力 → 描画」というゲーム・インタラクティブアートの基本になります。


## 5. 課題（LMS提出）

```{admonition} 課題
1. 背景色・円・四角形の色やサイズ・位置を自由に変更し，自分なりの画面をデザインする。
2. プログラムを実行して，ウィンドウが開いている状態のスクリーンショットを撮る。
3. スクリーンショットをLMSに提出する。

注意：
- ウィンドウを閉じる前に撮影してください。
- これ以降の回の評価のベースになるので，このプログラム (`lesson05.py`) は消さずにとっておいてください。
```


## 6. ライセンス

```{note}
このページの本文と図版は CC BY-NC-SA 4.0 とします。  
サンプルコードは MIT License とします。  
一部の学生作品のスクリーンショットなどはこの限りではありません。  
提出物（あなた自身のコードやスクリーンショット）は，ポートフォリオや就職活動で自由に使ってよいものとします。
```
