<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>PyGame-CEによるインタラクティブ表現入門その3：動きと衝突の基礎とゲームへの応用 - 流体工学セミナー・教材集</title><meta property="og:title" content="PyGame-CEによるインタラクティブ表現入門その3：動きと衝突の基礎とゲームへの応用 - 流体工学セミナー・教材集"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><meta name="image" content="https://akonno.github.io/FluidSeminarMaterials//build/screenshot3-1-8a46c52397cdd4dcc91823ee7249635e.png"/><meta property="og:image" content="https://akonno.github.io/FluidSeminarMaterials//build/screenshot3-1-8a46c52397cdd4dcc91823ee7249635e.png"/><link rel="stylesheet" href="https://akonno.github.io/FluidSeminarMaterials//build/_assets/app-IZWEOBHI.css"/><link rel="stylesheet" href="https://akonno.github.io/FluidSeminarMaterials//build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="https://akonno.github.io/FluidSeminarMaterials//favicon.ico"/><link rel="stylesheet" href="https://akonno.github.io/FluidSeminarMaterials//myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="https://akonno.github.io/FluidSeminarMaterials//"><span class="text-md sm:text-xl tracking-tight sm:mr-5">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R74op:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="流体工学セミナー・教材集" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="https://akonno.github.io/FluidSeminarMaterials//">流体工学セミナー・教材集</a><a title="MiniforgeではじめるPythonプログラミング" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="https://akonno.github.io/FluidSeminarMaterials//miniforge">MiniforgeではじめるPythonプログラミング</a><a title="JupyterLabの導入" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="https://akonno.github.io/FluidSeminarMaterials//jupyterlab">JupyterLabの導入</a><a title="KodingBasicsでプログラミング課題に挑戦" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="https://akonno.github.io/FluidSeminarMaterials//kodingbasics">KodingBasicsでプログラミング課題に挑戦</a><a title="PyGame-CEによるインタラクティブ表現入門その1：PyGame-CEのインストールと実行" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="https://akonno.github.io/FluidSeminarMaterials//pygame1">PyGame-CEによるインタラクティブ表現入門その1：PyGame-CEのインストールと実行</a><a title="PyGame-CEによるインタラクティブ表現入門その2：PyGame-CEの基本とアニメーション" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="https://akonno.github.io/FluidSeminarMaterials//pygame2">PyGame-CEによるインタラクティブ表現入門その2：PyGame-CEの基本とアニメーション</a><a title="PyGame-CEによるインタラクティブ表現入門その3：動きと衝突の基礎とゲームへの応用" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="https://akonno.github.io/FluidSeminarMaterials//pygame3">PyGame-CEによるインタラクティブ表現入門その3：動きと衝突の基礎とゲームへの応用</a></div></nav></div><div class="flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center mb-5 h-6 text-sm font-light"><div class="flex-grow"></div><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8top:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">PyGame-CEによるインタラクティブ表現入門その3：動きと衝突の基礎とゲームへの応用</h1></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Note</div></div><div class="myst-admonition-body px-4 py-1"><p>この回のゴール:</p><ol start="1"><li><p>位置・速度・加速度を用いて，ボールの運動をpygame-ceのアニメーションとして実装できる。</p></li><li><p>オイラー法による更新の意味と限界を理解し，加速度が一定の場合のより精度の高い位置の計算式（(x += v , dt + 0.5 a , dt^2)）をプログラムに組み込める。</p></li><li><p>円と壁・長方形（辺および角）との衝突判定と，速度ベクトルの反射による「跳ね返り」の表現を実装できる。</p></li><li><p>マウス操作などの入力と運動・衝突処理を組み合わせて，テニス風ゲームや障害物くぐりゲームなどの簡単な2Dゲームを自作できる。</p></li></ol></div></aside><h2 id="id" class="relative group"><span class="heading-text">ボールが跳ね返るアニメーションの作成</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>ボール（円）がウィンドウ上を移動し，ウィンドウの端で跳ね返るようなアニメーションを作成しよう．将来は物理シミュレーションに近づけられるよう，位置，速度，加速度を考慮したプログラムにしておく．</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import pygame

# 初期化
pygame.init()

# 400ピクセル×400ピクセルのウィンドウをつくる
WIDTH, HEIGHT = 400, 400
screen = pygame.display.set_mode((WIDTH, HEIGHT))
pygame.display.set_caption(&quot;PyGame-CE Program 2: ball motion&quot;)

clock = pygame.time.Clock()
running = True
mouseClicked = False

# 円の半径
r = 10
# 初期位置
x = 100
y = 100
# 初速度
vx = 3
vy = 2
# 加速度
ax = 0
ay = 0
# 時間刻み
dt = 1.0

# メインループ
while running:
    # 1. イベント処理
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            running = False  # ウィンドウ右上の×で終了
        elif event.type == pygame.MOUSEBUTTONUP:
            mouseClicked = False
        elif event.type == pygame.MOUSEBUTTONDOWN:
            mouseClicked = True
        # Sキーでスクショ保存
        elif event.type == pygame.KEYDOWN and event.key == pygame.K_s:
            pygame.image.save(screen, &quot;screenshot.png&quot;)
            print(f&quot;Saved screenshot to screenshot.png.&quot;)

    # 2. 位置を更新
    x += vx*dt
    y += vy*dt

    # 3. 速度を更新
    vx += ax*dt
    vy += ay*dt

    # 4. 壁にぶつかったら，速度を反転させる
    if x - r &lt; 0 and vx &lt; 0:
        vx = -vx
    elif x + r &gt; WIDTH and vx &gt; 0:
        vx = -vx
    if y - r &lt; 0 and vy &lt; 0:
        vy = -vy
    elif y + r &gt; HEIGHT and vy &gt; 0:
        vy = -vy

    # 5. 背景を塗る
    screen.fill((220, 220, 220))  # R,G,B [0-255]

    # 6. 図形を描く
    # 赤い円を(x, y)の位置に描く．
    pygame.draw.circle(screen, (255, 0, 0), (x, y), r)

    # 7. 画面を更新
    pygame.display.flip()

    # 8. フレームレート制御 (1秒あたり60フレーム程度)
    clock.tick(60)

# 終了処理
pygame.quit()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p>このプログラムを実行すると，ボールに見立てた赤い円が画面上を直線的に動き回り，またウィンドウの周囲では跳ね返る（跳ね返っているように運動の向きを変える）．どうしてそのように動作するのか，今後の改造に向けてプログラムの中身を理解しておこう．</p><figure id="fig-ss3-1" class="fig-figure"><img id="Be5NgevETA" style="margin:0 auto" src="https://akonno.github.io/FluidSeminarMaterials//build/screenshot3-1-8a46c52397cdd4dcc91823ee7249635e.png" alt="ボールが跳ね返るプログラムを実行した例．ただしこの例では画面を完全には消さず，ボールの軌道がだんだん薄くなりながら画面に残るように表示している．ボールが直線的に動いていること，壁（ウィンドウの外枠）で跳ね返っていることが分かる．" data-canonical-url="./images/media/screenshot3-1.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-ss3-1" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->71<!-- -->:</a>ボールが跳ね返るプログラムを実行した例．ただしこの例では画面を完全には消さず，ボールの軌道がだんだん薄くなりながら画面に残るように表示している．ボールが直線的に動いていること，壁（ウィンドウの外枠）で跳ね返っていることが分かる．</p></figcaption></figure><aside class="myst-admonition myst-admonition-important my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path fill-rule="evenodd" d="M14.615 1.595a.75.75 0 0 1 .359.852L12.982 9.75h7.268a.75.75 0 0 1 .548 1.262l-10.5 11.25a.75.75 0 0 1-1.272-.71l1.992-7.302H3.75a.75.75 0 0 1-.548-1.262l10.5-11.25a.75.75 0 0 1 .913-.143Z" clip-rule="evenodd"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">ポイント</div></div><div class="myst-admonition-body px-4 py-1"><ul><li><p><strong>メインループ</strong>に入る前に，円の半径，初期位置，初速度，加速度が定義されている．ただしいまは加速度が<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span>方向，<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span>方向ともに0なので，速度は壁にぶつからない限り一定のままである．</p></li><li><p>位置と速度は常微分方程式を数値的に解く最も基本的な方法である<strong>オイラー陽解法</strong>で計算されている．すなわち，以下のようにして計算される．</p><ul><li><p><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mi>x</mi><mi>n</mi></msup><mo>+</mo><msub><mi>v</mi><mi>x</mi></msub><mo>⋅</mo><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">x^{n+1} = x^n + v_x \cdot dt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7477em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5945em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span></span></span></span></span></p></li><li><p><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mi>y</mi><mi>n</mi></msup><mo>+</mo><msub><mi>v</mi><mi>y</mi></msub><mo>⋅</mo><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">y^{n+1} = y^n + v_y \cdot dt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8588em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7306em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span></span></span></span></span></p></li><li><p><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>v</mi><mi>x</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>=</mo><msubsup><mi>v</mi><mi>x</mi><mi>n</mi></msubsup><mo>+</mo><msub><mi>a</mi><mi>x</mi></msub><mo>⋅</mo><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">v_x^{n+1} = v_x^n + a_x \cdot dt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0611em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9114em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5945em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span></span></span></span></span></p></li><li><p><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>v</mi><mi>y</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>=</mo><msubsup><mi>v</mi><mi>y</mi><mi>n</mi></msubsup><mo>+</mo><msub><mi>a</mi><mi>y</mi></msub><mo>⋅</mo><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">v_y^{n+1} = v_y^n + a_y \cdot dt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1972em;vertical-align:-0.3831em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0475em;vertical-align:-0.3831em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7306em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span></span></span></span></span></p></li><li><p>ここでは上付き文字をタイムステップの意味で使っているので注意されたい．<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">x^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6644em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span>は<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span>の<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span>乗ではなく，<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span>ステップ目での<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span>座標を表す．</p></li><li><p>オイラー陽解法は陽的オイラー法または単にオイラー法と呼ばれることもある．後で述べるがこの方法は精度が良くないので，改善が必要である．</p></li></ul></li><li><p>壁にぶつかったことを壁からの距離と速度で判定している．たとえば左の壁に衝突した場合には，以下のように判定して速度を反転させる．</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">  if x - r &lt; 0 and vx &lt; 0:
      vx = -vx</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p>つまり円の左端の位置が壁の位置よりも左になり（壁にめり込むことに相当），かつ，速度の<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span>方向成分が負だったら，速度の<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span>方向成分を反転させる．右および上下の壁も同様である．</p><ul><li><p>壁からの距離だけでなく速度も判定に使っているのは，計算上の誤差によりボールが壁にくっつくような動きになるのを抑えるためである．速度の評価をせず位置だけ見て速度を反転させると，一度壁で跳ね返ったあと（速度を反転させたあと）にまだ壁から近かった場合に，もういちど速度を反転させてしまうことがある．速度が壁に向かっているときだけ反転させれば，このような不具合は発生しないので，速度も見るようにする．</p></li><li><p>壁では速度の符号を入れ替えているだけで，減衰は入れていない（速度の絶対値は変えていない）ので，完全弾性衝突（反発係数<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">e=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span>）に相当する衝突になっている．</p></li></ul></li></ul></div></aside><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500 exercise"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">演習課題</div></div><div class="myst-admonition-body px-4 py-1"><ol start="1"><li><p>速度を変えてみよ．</p></li><li><p>ボールの色を変えてみよ．</p></li></ol></div></aside><h2 id="id-1" class="relative group"><span class="heading-text">重力の導入と計算精度向上</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>重力のような効果を入れるため，<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span>方向加速度を設定してみよう．</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">ay = 0.5</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p>PyGame-CEでは<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span>軸の正は下向きなので，<code>ay</code>に正の値を入れると画面上では下向きに加速する．つまり下向きの重力がはたらくことに相当する．（画面はピクセル単位で，物理空間とは単位が異なるため，<code>ay</code>に重力加速度の正しい値を与えることはあまり意味が無く，適切なアニメーションになるような値を設定すれば良い．）</p><p>このように変えると，ボールが地面で跳ね返るようなアニメーションが表示されることと思う．</p><p>ただしアニメーションをずっと表示し続けると，おそらくだんだんとボールの跳ね返る高さが高くなり，ついには天井にぶつかり，その後もだんだん速くなり続けるだろう．上に述べたように完全弾性衝突に当たる計算をしているから，正しく計算されていればずっと同じ高さまで跳ね返り続けるはずである．どうしてだんだん高くなるのだろうか?</p><figure id="fig-ss3-2" class="fig-figure"><img id="D4UuTE5URB" style="margin:0 auto" src="https://akonno.github.io/FluidSeminarMaterials//build/screenshot3-2-62852a854f443b7bc9a2a5b73835513f.png" alt="ボールが跳ね返るプログラムを実行した例・重力あり．地面で跳ね返ったボールが放物線を描いて再び落下する様子や，跳ね返る高さがだんだん高くなる様子が分かる．" data-canonical-url="./images/media/screenshot3-2.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-ss3-2" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->72<!-- -->:</a>ボールが跳ね返るプログラムを実行した例・重力あり．地面で跳ね返ったボールが放物線を描いて再び落下する様子や，跳ね返る高さがだんだん高くなる様子が分かる．</p></figcaption></figure><h3 id="id-2" class="relative group"><span class="heading-text">位置の計算精度向上</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>いまのプログラムでは，位置と速度は常微分方程式を数値的に解く最も基本的な方法であるオイラー陽解法で計算されているが，この解法は精度が良くない．速度は時間刻み<code>dt</code>の間にだんだんと変化するはずだが，位置を計算するに際してはそのことを考慮せず，<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span>ステップ目での速度をそのまま用いて<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span>ステップ目での位置を求めているからである．特に今回のように常に下向きに加速している場合は，<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span>方向の速度が<code>dt</code>の間に相対的に下向きに変化することを無視しているので，どんどん高いほうにずれていく．</p><p>これを改善する方法はいろいろ提案されているが，今回は加速度が一定であることを利用して位置の計算を改善しよう．</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">    x += vx*dt + 0.5*ax*dt*dt
    y += vy*dt + 0.5*ay*dt*dt</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p>このように<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span>と<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span>の計算に速度だけでなく，加速度も考慮する．この方法は加速度が一定の場合には解析解を与える．（高校物理または大学1年次の物理の授業で学んでいる式だと思われる．忘れていたら復習しよう．）</p><figure id="fig-ss3-3" class="fig-figure"><img id="h4Z4JvvpDS" style="margin:0 auto" src="https://akonno.github.io/FluidSeminarMaterials//build/screenshot3-3-b780c641f31ec8c293575a7e574291b3.png" alt="ボールが跳ね返るプログラムを実行した例・重力あり，制度改善版．跳ね返る高さがほぼ一定になったことが分かる．" data-canonical-url="./images/media/screenshot3-3.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-ss3-3" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->73<!-- -->:</a>ボールが跳ね返るプログラムを実行した例・重力あり，制度改善版．跳ね返る高さがほぼ一定になったことが分かる．</p></figcaption></figure><h2 id="id-3" class="relative group"><span class="heading-text">衝突の判定の拡張・長方形との衝突</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-3" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>壁以外のものとの衝突を導入しよう．たとえば長方形を画面上に描き，それと衝突したら跳ね返るようにする．</p><p>長方形は画面の端に平行に置き，その領域は左上の座標<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>u</mi><mi>l</mi></mrow></msub><mo separator="true">,</mo><msub><mi>y</mi><mrow><mi>u</mi><mi>l</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_{ul}, y_{ul})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>と右下の座標<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>l</mi><mi>r</mi></mrow></msub><mo separator="true">,</mo><msub><mi>y</mi><mrow><mi>l</mi><mi>r</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_{lr}, y_{lr})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>で表すこととする．はじめは固定座標としよう．
（ul, lrはそれぞれupper left, lower rightの意味）</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># 長方形を配置
x_ul = 150  # 左上のx座標
y_ul = 250  # 左上のy座標
x_lr = 300  # 右下のx座標
y_lr = 270  # 右下のy座標</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p>そしてメインループの中で，長方形ボール（円）が衝突したら跳ね返るようにしよう．</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">    # 4b. 長方形にぶつかったら，速度を反転させる．
    # 簡易版
    # 長方形の左辺にぶつかった場合
    if vx &gt; 0 and x + r &gt;= x_ul and x - r &lt; x_ul:
        if y + r &gt;= y_ul and y - r &lt;= y_lr:
            vx = -vx
            x = x_ul - r
    
    # 長方形の右辺にぶつかった場合
    if vx &lt; 0 and x - r &lt;= x_lr and x + r &gt; x_lr:
        if y + r &gt;= y_ul and y - r &lt;= y_lr:
            vx = -vx
            x = x_lr + r
    
    # 長方形の上辺にぶつかった場合
    if vy &gt; 0 and y + r &gt;= y_ul and y - r &lt; y_ul:
        if x + r &gt;= x_ul and x - r &lt;= x_lr:
            vy = -vy
            y = y_ul - r
    
    # 長方形の下辺にぶつかった場合
    if vy &lt; 0 and y - r &lt;= y_lr and y + r &gt; y_lr:
        if x + r &gt;= x_ul and x - r &lt;= x_lr:
            vy = -vy
            y = y_lr + r</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><figure id="fig-ss3-4" class="fig-figure"><img id="q33EcPIUio" style="margin:0 auto" src="https://akonno.github.io/FluidSeminarMaterials//build/screenshot3-4-3a7b82a6434215216641400e17826d2d.png" alt="ボールが壁面および配置された長方形と衝突すると跳ね返るプログラムを実行した例・重力あり" data-canonical-url="./images/media/screenshot3-4.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-ss3-4" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->74<!-- -->:</a>ボールが壁面および配置された長方形と衝突すると跳ね返るプログラムを実行した例・重力あり</p></figcaption></figure><h2 id="id-4" class="relative group"><span class="heading-text">マウスの動きに合わせて長方形を動かす</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-4" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>長方形が固定のままだと発展性がないので，マウスの動きに合わせて長方形が動くようにしてみよう．</p><p>以前の教材で学んだように，マウスカーソルの位置は<code>mx, my = pygame.mouse.get_pos()</code>で得られるので，長方形の位置をそれに合わせて動かす．今回は長方形の高さは固定し，横方向にのみ動かしてみる．</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">    # マウス位置を取得
    mx, my = pygame.mouse.get_pos()

    # マウスの位置に合わせて長方形の位置を変える
    x_ul = mx - 50
    x_lr = mx + 50</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500 exercise"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">演習課題</div></div><div class="myst-admonition-body px-4 py-1"><p>上のコードをプログラムのどこに入れれば良いか? 適切な場所に入れて，マウスの動きに合わせて長方形が動くようにせよ．</p></div></aside><figure id="fig-ss3-5" class="fig-figure"><img id="QEFyNrBJht" style="margin:0 auto" src="https://akonno.github.io/FluidSeminarMaterials//build/screenshot3-5-4e72506b24e0c8ba5a52d09b48f1caeb.png" alt="ボールが壁面および配置された長方形と衝突すると跳ね返るプログラムを実行した例・長方形がマウスの動きに合わせて横移動する場合" data-canonical-url="./images/media/screenshot3-5.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-ss3-5" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->75<!-- -->:</a>ボールが壁面および配置された長方形と衝突すると跳ね返るプログラムを実行した例・長方形がマウスの動きに合わせて横移動する場合</p></figcaption></figure><h2 id="id-5" class="relative group"><span class="heading-text">発展：衝突判定の改善</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-5" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>現在の衝突のコードは判定が簡略化されており，特に長方形の角にボールが近づいた場合には実際に衝突する前に跳ね返る．また跳ね返る方向は常に衝突した方向の真逆である．これをより現実的な衝突に変更したい．</p><figure id="fig-ss3-6" class="fig-figure"><img id="uWq9wOBzTS" style="margin:0 auto" src="https://akonno.github.io/FluidSeminarMaterials//build/screenshot3-6-289e49eee58c9d98d1ca2c27cdade7dc.png" alt="ボールが壁面および配置された長方形と衝突すると跳ね返るプログラムで，ボールが長方形の左上隅に「衝突」している例．実際にはボールと長方形とは接触しておらず，また衝突前と速度が反転していることが分かる．" data-canonical-url="./images/media/screenshot3-6.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-ss3-6" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->76<!-- -->:</a>ボールが壁面および配置された長方形と衝突すると跳ね返るプログラムで，ボールが長方形の左上隅に「衝突」している例．実際にはボールと長方形とは接触しておらず，また衝突前と速度が反転していることが分かる．</p></figcaption></figure><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500 exercise"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">演習課題</div></div><div class="myst-admonition-body px-4 py-1"><p>先ほど作成したプログラムを用い，実際に長方形の角にボールをぶつけてみて，どのように跳ね返るか確認せよ．</p></div></aside><p>衝突を改善するにあたり，まずボールの位置によって衝突判定を<span data-state="closed"><a href="#fig-collision-rectangle" class="hover-link">Figure <!-- -->77</a></span>のように8通りに分類する．</p><figure id="fig-collision-rectangle" class="fig-figure"><img id="wZNQbwiUuP" style="margin:0 auto" src="https://akonno.github.io/FluidSeminarMaterials//build/collision-rectangle.-00a44734bfc28f9e5ed3adf20fa6aece.png" alt="ボールと長方形との衝突の場合分け．ボールの中心が長方形まわりのどの位置にあるかによって，衝突判定を8通りに分類する．" data-canonical-url="./images/collision-rectangle.drawio.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-collision-rectangle" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->77<!-- -->:</a>ボールと長方形との衝突の場合分け．ボールの中心が長方形まわりのどの位置にあるかによって，衝突判定を8通りに分類する．</p></figcaption></figure><p>ボールの中心が①～④のいずれかにある場合の衝突判定と跳ね返りは，以前に示した衝突と同じように扱う．ボールの中心が⑤～⑧のいずれかにある場合は，長方形の角に衝突するものとして取り扱う．</p><p>ここでは長方形の角に当たった場合には，角に向かって心向き直衝突しているものと考える．つまり角からボールの中心に向かうベクトルを考えたとき，角の位置にはこのベクトルと垂直な壁があり，これと衝突し跳ね返ると考える．従って速度の角→ボール中心向きの成分を取りだし，それを反転させる．</p><p>角→ボール中心に向かうベクトルは，</p><div id="PZZnnLaV2w" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="bold-italic">n</mi><mo>=</mo><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mi>c</mi></msub><mo separator="true">,</mo><mi>y</mi><mo>−</mo><msub><mi>y</mi><mi>c</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\boldsymbol{n}=(x-x_{c}, y-y_{c})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">n</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#PZZnnLaV2w" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->1<!-- -->)</a></div></div><p>と書ける．ここで<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mi>c</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>c</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_c, y_c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>は角の座標である．</p><p>このベクトルの長さが円の半径<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></span>以下のとき，角と衝突している．以下の式では<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span>（太字でない<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span>）を<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">n</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">n</span></span></span></span></span></span></span>（太字の<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">n</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">n</span></span></span></span></span></span></span>，ベクトルを表す）の大きさの意味で使っている．</p><div id="LZyFSmous4" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>n</mi><mn>2</mn></msup><mo>=</mo><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mi>c</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy="false">(</mo><mi>y</mi><mo>−</mo><msub><mi>y</mi><mi>c</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>≤</mo><msup><mi>r</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">n^2=(x-x_c)^2+(y-y_c)^2\leq r^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8641em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8641em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#LZyFSmous4" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->2<!-- -->)</a></div></div><p>今後の計算のため，法線ベクトル<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">n</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">n</span></span></span></span></span></span></span>を単位法線ベクトルに変換したものを作る．</p><div id="l1935joz08" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi mathvariant="bold-italic">n</mi><mo>^</mo></mover><mo>=</mo><mfrac><mi mathvariant="bold-italic">n</mi><mi>n</mi></mfrac></mrow><annotation encoding="application/x-tex">\hat{\boldsymbol{n}}=\frac{\boldsymbol{n}}{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7079em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7079em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">n</span></span></span></span><span style="top:-3.0134em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.8074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">n</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#l1935joz08" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->3<!-- -->)</a></div></div><p>現在の速度を<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>v</mi><mi>x</mi></msub><mo separator="true">,</mo><msub><mi>v</mi><mi>y</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(v_x, v_y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>とすると，法線方向成分はこれと<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi mathvariant="bold-italic">n</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{\boldsymbol{n}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7079em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7079em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">n</span></span></span></span><span style="top:-3.0134em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span></span>との内積で求められる．</p><div id="se5NuXL1kC" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>v</mi><mi>n</mi></msub><mo>=</mo><mi mathvariant="bold-italic">v</mi><mo>⋅</mo><mover accent="true"><mi mathvariant="bold-italic">n</mi><mo>^</mo></mover><mo>=</mo><msub><mi>v</mi><mi>x</mi></msub><msub><mover accent="true"><mi>n</mi><mo>^</mo></mover><mi>x</mi></msub><mo>+</mo><msub><mi>v</mi><mi>y</mi></msub><msub><mover accent="true"><mi>n</mi><mo>^</mo></mover><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">v_n = \boldsymbol{v}\cdot\hat{\boldsymbol{n}}=v_x\hat{n}_x+v_y\hat{n}_y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">v</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7079em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7079em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">n</span></span></span></span><span style="top:-3.0134em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">n</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">n</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#se5NuXL1kC" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->4<!-- -->)</a></div></div><p>もし<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>n</mi></msub><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">v_n\geq 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.786em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span>なら，ボールは角から離れる方向に動いているので，速度は変えなくてよい．<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>n</mi></msub><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">v_n&lt;0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span>ならボールは角に向かって動いているので，その成分だけ反転させる．</p><div id="eUu0FuXDX9" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi mathvariant="bold-italic">v</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mi mathvariant="bold-italic">v</mi><mo>−</mo><mn>2</mn><msub><mi>v</mi><mi>n</mi></msub><mover accent="true"><mi mathvariant="bold-italic">n</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\boldsymbol{v}&#x27;=\boldsymbol{v}-2v_n\hat{\boldsymbol{n}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8019em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">v</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">v</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8579em;vertical-align:-0.15em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7079em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol">n</span></span></span></span><span style="top:-3.0134em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#eUu0FuXDX9" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->5<!-- -->)</a></div></div><p>これにより角→ボール中心方向成分のみ符号が変わり，接線方向（角→ボール中心方向と垂直な成分）は維持される．</p><p>ここで検討した計算方法を，Pythonの関数にしよう．</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import math

def collide_circle_corner(x, y, r, vx, vy, x_c, y_c):
    &quot;&quot;&quot;
    ボール（中心 x, y, 半径 r）と、長方形の角 (x_c, y_c) の衝突を判定し、
    ボールが角に向かっている場合は速度ベクトルを反射させる。

    返り値: (vx_new, vy_new)
    &quot;&quot;&quot;

    # 角 → ボール中心のベクトル
    dx = x - x_c
    dy = y - y_c

    dist = math.sqrt(dx*dx + dy*dy)

    # 衝突はすでに判定済みとする．（dist &lt;= r のときに呼び出される想定）

    # 単位法線ベクトル（角 → ボール中心）
    nx = dx / dist
    ny = dy / dist

    # 法線方向速度成分 v_n を求める
    v_n = vx * nx + vy * ny  # 法線方向速度成分 v_n

    # v_n &lt; 0 のときだけ「角に向かっている」ので反射させる
    if v_n &lt; 0:
        # 反射: v&#x27; = v - 2 (v・n) n
        vx -= 2.0 * v_n * nx
        vy -= 2.0 * v_n * ny

    return vx, vy</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p>そして，⑤～⑧の場合はこの関数を使って衝突後の速度を求める．</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">    # ①左辺にぶつかった場合
    if x &lt; x_ul and y_ul &lt;= y and y &lt;= y_lr and x + r &gt;= x_ul and vx &gt; 0:
        vx = -vx
    # ②右辺にぶつかった場合
    elif x &gt; x_lr and y_ul &lt;= y and y &lt;= y_lr and x - r &lt;= x_lr and vx &lt; 0:
        vx = -vx
    # ③上辺にぶつかった場合
    elif y &lt; y_ul and x_ul &lt;= x and x &lt;= x_lr and y + r &gt;= y_ul and vy &gt; 0:
        vy = -vy
    # ④下辺にぶつかった場合
    elif y &gt; y_lr and x_ul &lt;= x and x &lt;= x_lr and y - r &lt;= y_lr and vy &lt; 0:
        vy = -vy
    # ⑤左上隅にぶつかった場合
    elif x &lt; x_ul and y &lt; y_ul and (x - x_ul)**2 + (y - y_ul)**2 &lt;= r**2:
        vx, vy = collide_circle_corner(x, y, r, vx, vy, x_ul, y_ul)
    # ⑥右上隅にぶつかった場合
    elif x &gt; x_lr and y &lt; y_ul and (x - x_lr)**2 + (y - y_ul)**2 &lt;= r**2:
        vx, vy = collide_circle_corner(x, y, r, vx, vy, x_lr, y_ul)
    # ⑦左下隅にぶつかった場合
    elif x &lt; x_ul and y &gt; y_lr and (x - x_ul)**2 + (y - y_lr)**2 &lt;= r**2:
        vx, vy = collide_circle_corner(x, y, r, vx, vy, x_ul, y_lr)
    # ⑧右下隅にぶつかった場合
    elif x &gt; x_lr and y &gt; y_lr and (x - x_lr)**2 + (y - y_lr)**2 &lt;= r**2:
        vx, vy = collide_circle_corner(x, y, r, vx, vy, x_lr, y_lr)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><figure id="fig-ss3-7" class="fig-figure"><img id="LR9C9sXYiN" style="margin:0 auto" src="https://akonno.github.io/FluidSeminarMaterials//build/screenshot3-7-d5784260980b5f6365f0533230b3ba3d.png" alt="ボールと長方形との角の衝突を改善した例．なおボールが角にぶつかりやすいように，ボールの半径を大きくしている．ボールが長方形の右上隅に衝突して速度ベクトルの向きが変わっていることが分かる．" data-canonical-url="./images/media/screenshot3-7.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-ss3-7" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->78<!-- -->:</a>ボールと長方形との角の衝突を改善した例．なおボールが角にぶつかりやすいように，ボールの半径を大きくしている．ボールが長方形の右上隅に衝突して速度ベクトルの向きが変わっていることが分かる．</p></figcaption></figure><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500 exercise"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">演習課題</div></div><div class="myst-admonition-body px-4 py-1"><p>ここまで検討した内容を用いて，長方形の角での衝突を改善せよ．</p></div></aside><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500 exercise"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">演習課題（発展）</div></div><div class="myst-admonition-body px-4 py-1"><p><span data-state="closed"><a href="#fig-ss3-7" class="hover-link">Figure <!-- -->78</a></span>では，長方形に少し食い込んでいるように見える．これはなぜか? またプログラムを改変して，ボールが長方形に食い込まないようにせよ．ただし「ボールを小さくする」のと「ボールの動きをゆっくりにする」のは除外し，いまと同様の速度でボールが動きつつ，衝突計算精度を向上させよ．</p></div></aside><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500 exercise"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">演習課題（発展）</div></div><div class="myst-admonition-body px-4 py-1"><p>長方形をマウスで動かす場合において，長方形を動かす速度が衝突後の反発に影響するようにせよ．端的には衝突時の相対速度を考慮し，それによって衝突後の速度が変わるようにせよ．</p></div></aside><h2 id="id-flappy-bird" class="relative group"><span class="heading-text">障害物くぐりゲーム（Flappy Bird風）</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-flappy-bird" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Flappy Bird風の障害物くぐりゲームを作ろう．ボールを壁や長方形に衝突しないように操作し，衝突したらゲームオーバーとする．</p><h3 id="id-6" class="relative group"><span class="heading-text">マウスのクリックに応じて動きを変える</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-6" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>はじめに，ボールが<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span>軸方向にのみ動くようにし，またマウスをクリックしている間は上向きに，クリックしていないときは下向きに動くようにしよう．長方形はいったん消す．</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">    if mouseClicked:
        vy = -2
    else:
        vy = 2
    
    # 2. 位置（yのみ）を更新（加速度は使わない）
    y += vy*dt</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p>これで，マウスをクリックしているときは上向き，クリックしていないときは下向きにボールが動くはずである．</p><h3 id="id-7" class="relative group"><span class="heading-text">衝突判定の拡張：複数の長方形と衝突判定</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-7" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>障害物として複数の長方形が画面に現れ，右から左に向かって動くようにしよう．そのためには複数の長方形を扱う必要があるので，「長方形との衝突」を扱う関数を作ろう．</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">
def collision_test(x, y, r, x_ul, y_ul, x_lr, y_lr):
    &quot;&quot;&quot;円と矩形の衝突判定（詳細版）&quot;&quot;&quot;
    # ①左辺にぶつかった場合
    if x &lt; x_ul and y_ul &lt;= y and y &lt;= y_lr and x + r &gt;= x_ul:
        return True
    # ②右辺にぶつかった場合
    elif x &gt; x_lr and y_ul &lt;= y and y &lt;= y_lr and x - r &lt;= x_lr:
        return True
    # ③上辺にぶつかった場合
    elif y &lt; y_ul and x_ul &lt;= x and x &lt;= x_lr and y + r &gt;= y_ul:
        return True
    # ④下辺にぶつかった場合
    elif y &gt; y_lr and x_ul &lt;= x and x &lt;= x_lr and y - r &lt;= y_lr:
        return True
    # ⑤左上隅にぶつかった場合
    elif x &lt; x_ul and y &lt; y_ul and (x - x_ul)**2 + (y - y_ul)**2 &lt;= r**2:
        return True
    # ⑥右上隅にぶつかった場合
    elif x &gt; x_lr and y &lt; y_ul and (x - x_lr)**2 + (y - y_ul)**2 &lt;= r**2:
        return True
    # ⑦左下隅にぶつかった場合
    elif x &lt; x_ul and y &gt; y_lr and (x - x_ul)**2 + (y - y_lr)**2 &lt;= r**2:
        return True
    # ⑧右下隅にぶつかった場合
    elif x &gt; x_lr and y &gt; y_lr and (x - x_lr)**2 + (y - y_lr)**2 &lt;= r**2:
        return True
    return False</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p>障害物は上下セットで2つ×5段階程度を配置する．最初は画面の右外に配置し，だんだん画面内に入ってくるようにする．</p><p>以下のコードでは障害物で通り抜けられる部分の位置をランダムに決め，それより上とそれより下に障害物となる長方形が置かれるように座標を計算する．そして<code>obstacles</code>というリストを用意し，これに障害物となる長方形を格納している．</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># 障害物群を作る．
import random
obstacles = []
span_x = 200    # 障害物を置く間隔
x_start = WIDTH + 50
for _ in range(5):
    # 障害物で「空いている部分」の高さを決める．
    hole_y = random.randint(30, HEIGHT - 90)
    obstacles.append( [ x_start, 0, x_start + 50, hole_y] )  # 上の矩形
    obstacles.append( [ x_start, hole_y + 80, x_start + 50, HEIGHT] )  # 下の矩形
    x_start += span_x</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p>壁や長方形との衝突を判定する必要がある．衝突したらゲームオーバーにするので，跳ね返りを計算する必要はない．衝突したかどうかを保持する変数<code>collided</code>を用意する．</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">collided = False</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p>そしてメインループの中で，壁や障害物（長方形）との衝突を判定する．障害物は複数あるので，<code>for</code>ループを使って個々の障害物との衝突を判定する．ここで先ほど作った衝突判定関数<code>collision_test</code>が使われている．</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">    # 4a. 壁にぶつかったら，ゲームオーバー
    if y - r &lt;= 0 and vy &lt; 0:
        collided = True
    elif y + r &gt;= HEIGHT and vy &gt; 0:
        collided = True
    
    # 4b. 矩形にぶつかったら，ゲームオーバー
    for obs in obstacles:
        x_ul, y_ul, x_lr, y_lr = obs
        if collision_test(x, y, r, x_ul, y_ul, x_lr, y_lr):
            collided = True
            break</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p>障害物は右から左にゆっくりと動かす．つまり障害物の<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span>座標をだんだん小さくする．障害物が左の壁を通過したら，もういちど右側に持って行く．</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">        # 一番右の障害物の位置を調べる
        max_x = 0
        for o in obstacles:
            if o[0] &gt; max_x:
                max_x = o[0]
        # 長方形を左に向かって少しずつ移動
        for obs in obstacles:
            obs[0] -= 0.5
            obs[2] -= 0.5
            # 画面外に出た障害物は，一番左にある障害物からx_span空けた位置に再配置
            if obs[2] &lt; 0:
                obs[0] = max_x + span_x
                obs[2] = max_x + span_x + 50</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p>障害物を画面に表示する機能も，忘れずにつけておく．</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">    # 6b. 障害物を描く
    for obs in obstacles:
        x_ul, y_ul, x_lr, y_lr = obs
        pygame.draw.rect(screen, (0, 0, 255), (x_ul, y_ul, x_lr - x_ul, y_lr - y_ul))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p>これでFlappy Bird風の障害物くぐりゲームの骨組みができた．</p><figure id="fig-ss3-8" class="fig-figure"><img id="ZWIcwsqcBu" style="margin:0 auto" src="https://akonno.github.io/FluidSeminarMaterials//build/screenshot3-8-6dd431e554405963f4e72e30317af1ad.png" alt="障害物くぐりゲームの画面" data-canonical-url="./images/media/screenshot3-8.png" class=""/><figcaption class="group"><p><a class="no-underline text-inherit hover:text-inherit mr-1 font-semibold text-inherit hover:text-inherit hover:font-semibold select-none hover:underline" href="#fig-ss3-8" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->79<!-- -->:</a>障害物くぐりゲームの画面</p></figcaption></figure><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500 exercise"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">演習課題</div></div><div class="myst-admonition-body px-4 py-1"><ol start="1"><li><p>ここまで検討してきた内容に基づき，障害物くぐりゲームを作成せよ．</p></li><li><p>障害物にぶつかったら，ゲームオーバーになるようにせよ．</p></li><li><p>スコアを表示し，障害物をくぐり抜けたらスコアが加算されるようにせよ．</p></li></ol></div></aside><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500 exercise"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">演習課題（発展）</div></div><div class="myst-admonition-body px-4 py-1"><ol start="1"><li><p>現在の障害物くぐりゲームでは，同じ障害物がローテーションして搭乗するが，障害物が画面の左に抜けたら穴の位置を新たに決めて，障害物を作り直すようにせよ．</p></li><li><p>ゲームの難易度がだんだん上がるように，障害物くぐりゲームを改変せよ．</p></li></ol></div></aside><h2 id="id-lms" class="relative group"><span class="heading-text">課題（LMS提出）</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-lms" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>以下に課題に取り組み，その成果物のソースコード，および成果物について説明するレポートを提出せよ．
提出方法および提出期限はKU-LMSで確認せよ．</p><p>レポートには以下の内容を含めること．</p><ol start="1"><li><p>作品の概要（ゲームのルールや目的）</p></li><li><p>操作方法および実行方法（使用ファイル、実行コマンド）</p></li><li><p>工夫した点・発展項目（課題2の場合）</p></li><li><p>実行中のスクリーンショット</p></li></ol><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500 assignment"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">課題1：最小のテニスゲーム（基礎）</div></div><div class="myst-admonition-body px-4 py-1"><p>「壁で跳ね返るボールのアニメーション」を改造し、
マウスで動くラケットでボールを打ち返すテニス風ゲームを作成せよ。</p><p>必須条件：</p><ul><li><p>重力は使わず（ax = ay = 0）、ボールは直線運動とする。</p></li><li><p>ラケット（長方形）に当たるとボールが左向きに跳ね返る。</p></li><li><p>ボールが左の壁に当たったら 1 点加算する。</p></li><li><p>ボールが右の壁に当たったらゲームオーバーとする。</p></li></ul></div></aside><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500 assignment"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">課題2：応用ゲーム（発展）</div></div><div class="myst-admonition-body px-4 py-1"><p>課題1を発展させ、オリジナルのゲームまたはインタラクティブ作品を作成せよ。
以下のような例を参考にしてよいが、教材で示したコードをそのまま提出することは不可とする。</p><p>例：</p><ul><li><p>ブロック崩し</p></li><li><p>エアホッケー</p></li><li><p>インタラクティブアート（軌跡・色・音など）</p></li><li><p>障害物くぐりゲーム（Flappy Bird風）<strong>※ただし必ず以下のいずれかを実装すること</strong></p></li></ul><p>障害物くぐりゲーム（Flappy Bird風）を選ぶ場合の必須追加条件：以下のいずれかの機能を導入すること．</p><ul><li><p>障害物の速度が時間経過で変化する（速くなる／遅くなる）</p></li><li><p>障害物の幅や隙間の大きさが変化する（難易度調整）</p></li><li><p>障害物が上下に動く（往復運動など）</p></li><li><p>背景スクロール、パーティクル、効果音など視覚・聴覚演出を追加</p></li><li><p>ゲームオーバー画面、タイトル画面、リトライ機能をつける</p></li><li><p>ステージ制（一定スコアで次の難易度へ）を導入</p></li></ul></div></aside><h2 id="id-8" class="relative group"><span class="heading-text">ライセンス</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-8" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Note</div></div><div class="myst-admonition-body px-4 py-1"><p>このページの本文と図版は CC BY-NC-SA 4.0 とします。<br/>サンプルコードは MIT License とします。<br/>一部の学生作品のスクリーンショットなどはこの限りではありません。<br/>提出物（あなた自身のコードやスクリーンショット）は，ポートフォリオや就職活動で自由に使ってよいものとします。</p></div></aside><div></div><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="https://akonno.github.io/FluidSeminarMaterials//pygame2"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">流体工学セミナー・教材集</div>PyGame-CEによるインタラクティブ表現入門その2：PyGame-CEの基本とアニメーション</div></div></a></div></article></main><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="https://akonno.github.io/FluidSeminarMaterials//build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="https://akonno.github.io/FluidSeminarMaterials//build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="https://akonno.github.io/FluidSeminarMaterials//build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="https://akonno.github.io/FluidSeminarMaterials//build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="https://akonno.github.io/FluidSeminarMaterials//build/_shared/chunk-F7G67JTZ.js"/><link rel="modulepreload" href="https://akonno.github.io/FluidSeminarMaterials//build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="https://akonno.github.io/FluidSeminarMaterials//build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="https://akonno.github.io/FluidSeminarMaterials//build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="https://akonno.github.io/FluidSeminarMaterials//build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="https://akonno.github.io/FluidSeminarMaterials//build/_shared/chunk-CPTH56EW.js"/><link rel="modulepreload" href="https://akonno.github.io/FluidSeminarMaterials//build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="https://akonno.github.io/FluidSeminarMaterials//build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="https://akonno.github.io/FluidSeminarMaterials//build/_shared/chunk-S4SWV34C.js"/><link rel="modulepreload" href="https://akonno.github.io/FluidSeminarMaterials//build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="https://akonno.github.io/FluidSeminarMaterials//build/root-7TUVC4ZT.js"/><link rel="modulepreload" href="https://akonno.github.io/FluidSeminarMaterials//build/_shared/chunk-INOWNUZ6.js"/><link rel="modulepreload" href="https://akonno.github.io/FluidSeminarMaterials//build/routes/$-P6PGXPYX.js"/><script>window.__remixContext = {"url":"/pygame3","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.6.4","options":{"style":"https://akonno.github.io/FluidSeminarMaterials//build/custom-53eb5b86b029b921f3ac2cf169a9705a.css"},"nav":[],"actions":[],"projects":[{"numbering":{"figure":{"enabled":true,"continue":true}},"title":"流体工学セミナー・教材集","toc":[{"file":"intro.md"},{"file":"miniforge.md"},{"file":"jupyterlab.md"},{"file":"kodingbasics.md"},{"file":"pygame1.md"},{"file":"pygame2.md"},{"file":"pygame3.md"}],"exports":[],"bibliography":[],"index":"index","pages":[{"slug":"miniforge","title":"MiniforgeではじめるPythonプログラミング","description":"","date":"","thumbnail":"https://akonno.github.io/FluidSeminarMaterials//build/image1-1e6971224340eba935a45f2a25ce2604.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"jupyterlab","title":"JupyterLabの導入","description":"","date":"","thumbnail":"https://akonno.github.io/FluidSeminarMaterials//build/jupyterlab01en-6395564036092c7a9e2ecb3c0798f24c.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"kodingbasics","title":"KodingBasicsでプログラミング課題に挑戦","description":"","date":"","thumbnail":"https://akonno.github.io/FluidSeminarMaterials//build/kodingbasics-toppage-1c318d62c5988c14b4b4771f3fff5b8b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"pygame1","title":"PyGame-CEによるインタラクティブ表現入門その1：PyGame-CEのインストールと実行","description":"","date":"","thumbnail":"https://akonno.github.io/FluidSeminarMaterials//build/editor01.drawio-e4be0ff2071909da362d6e010732f4c6.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"pygame2","title":"PyGame-CEによるインタラクティブ表現入門その2：PyGame-CEの基本とアニメーション","description":"","date":"","thumbnail":"https://akonno.github.io/FluidSeminarMaterials//build/screenshot2-1-d2f378fdb795ed11ec8865506d50ab92.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"pygame3","title":"PyGame-CEによるインタラクティブ表現入門その3：動きと衝突の基礎とゲームへの応用","description":"","date":"","thumbnail":"https://akonno.github.io/FluidSeminarMaterials//build/screenshot3-1-8a46c52397cdd4dcc91823ee7249635e.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"https://akonno.github.io/FluidSeminarMaterials/"},"routes/$":{"config":{"version":2,"myst":"1.6.4","options":{"style":"https://akonno.github.io/FluidSeminarMaterials//build/custom-53eb5b86b029b921f3ac2cf169a9705a.css"},"nav":[],"actions":[],"projects":[{"numbering":{"figure":{"enabled":true,"continue":true}},"title":"流体工学セミナー・教材集","toc":[{"file":"intro.md"},{"file":"miniforge.md"},{"file":"jupyterlab.md"},{"file":"kodingbasics.md"},{"file":"pygame1.md"},{"file":"pygame2.md"},{"file":"pygame3.md"}],"exports":[],"bibliography":[],"index":"index","pages":[{"slug":"miniforge","title":"MiniforgeではじめるPythonプログラミング","description":"","date":"","thumbnail":"https://akonno.github.io/FluidSeminarMaterials//build/image1-1e6971224340eba935a45f2a25ce2604.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"jupyterlab","title":"JupyterLabの導入","description":"","date":"","thumbnail":"https://akonno.github.io/FluidSeminarMaterials//build/jupyterlab01en-6395564036092c7a9e2ecb3c0798f24c.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"kodingbasics","title":"KodingBasicsでプログラミング課題に挑戦","description":"","date":"","thumbnail":"https://akonno.github.io/FluidSeminarMaterials//build/kodingbasics-toppage-1c318d62c5988c14b4b4771f3fff5b8b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"pygame1","title":"PyGame-CEによるインタラクティブ表現入門その1：PyGame-CEのインストールと実行","description":"","date":"","thumbnail":"https://akonno.github.io/FluidSeminarMaterials//build/editor01.drawio-e4be0ff2071909da362d6e010732f4c6.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"pygame2","title":"PyGame-CEによるインタラクティブ表現入門その2：PyGame-CEの基本とアニメーション","description":"","date":"","thumbnail":"https://akonno.github.io/FluidSeminarMaterials//build/screenshot2-1-d2f378fdb795ed11ec8865506d50ab92.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"pygame3","title":"PyGame-CEによるインタラクティブ表現入門その3：動きと衝突の基礎とゲームへの応用","description":"","date":"","thumbnail":"https://akonno.github.io/FluidSeminarMaterials//build/screenshot3-1-8a46c52397cdd4dcc91823ee7249635e.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"page":{"version":2,"kind":"Article","sha256":"61fdf6eec450fe88b64a82043349fb3c20718162e9e98d6b620f39319e3db99f","slug":"pygame3","location":"/pygame3.md","dependencies":[],"frontmatter":{"title":"PyGame-CEによるインタラクティブ表現入門その3：動きと衝突の基礎とゲームへの応用","content_includes_title":false,"numbering":{"figure":{"enabled":true,"continue":true}},"thumbnail":"https://akonno.github.io/FluidSeminarMaterials//build/screenshot3-1-8a46c52397cdd4dcc91823ee7249635e.png","exports":[{"format":"md","filename":"pygame3.md","url":"https://akonno.github.io/FluidSeminarMaterials//build/pygame3-f5be09bd74e110272576135925cf7496.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"JWQGnRjHDl"}],"key":"NZEw7Zs0qW"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"この回のゴール:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"cSom5hnC8o"}],"key":"KUSRp8oQT2"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"位置・速度・加速度を用いて，ボールの運動をpygame-ceのアニメーションとして実装できる。","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"jPEtFVWd8v"}],"key":"qnWzTY3lew"}],"key":"X8NES8PWe1"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"オイラー法による更新の意味と限界を理解し，加速度が一定の場合のより精度の高い位置の計算式（(x += v , dt + 0.5 a , dt^2)）をプログラムに組み込める。","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"rwnmARjaUr"}],"key":"KCMMSxFhLo"}],"key":"v1pC38bGRb"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"円と壁・長方形（辺および角）との衝突判定と，速度ベクトルの反射による「跳ね返り」の表現を実装できる。","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"DTeHJ46lUr"}],"key":"tz1Mk9yBwx"}],"key":"ZchkGXimCK"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"マウス操作などの入力と運動・衝突処理を組み合わせて，テニス風ゲームや障害物くぐりゲームなどの簡単な2Dゲームを自作できる。","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"pHPlG24Nvs"}],"key":"cbdG5gg2Es"}],"key":"lWbVEfXk8V"}],"key":"YczGquHBUh"}],"key":"U9Trk6mO5Q"},{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"ボールが跳ね返るアニメーションの作成","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"UP5pVMYPdv"}],"identifier":"id","label":"ボールが跳ね返るアニメーションの作成","html_id":"id","implicit":true,"key":"wQRzNu9Zw4"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"ボール（円）がウィンドウ上を移動し，ウィンドウの端で跳ね返るようなアニメーションを作成しよう．将来は物理シミュレーションに近づけられるよう，位置，速度，加速度を考慮したプログラムにしておく．","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Mt7VIla1I5"}],"key":"b8jdBED71o"},{"type":"code","lang":"python","value":"import pygame\n\n# 初期化\npygame.init()\n\n# 400ピクセル×400ピクセルのウィンドウをつくる\nWIDTH, HEIGHT = 400, 400\nscreen = pygame.display.set_mode((WIDTH, HEIGHT))\npygame.display.set_caption(\"PyGame-CE Program 2: ball motion\")\n\nclock = pygame.time.Clock()\nrunning = True\nmouseClicked = False\n\n# 円の半径\nr = 10\n# 初期位置\nx = 100\ny = 100\n# 初速度\nvx = 3\nvy = 2\n# 加速度\nax = 0\nay = 0\n# 時間刻み\ndt = 1.0\n\n# メインループ\nwhile running:\n    # 1. イベント処理\n    for event in pygame.event.get():\n        if event.type == pygame.QUIT:\n            running = False  # ウィンドウ右上の×で終了\n        elif event.type == pygame.MOUSEBUTTONUP:\n            mouseClicked = False\n        elif event.type == pygame.MOUSEBUTTONDOWN:\n            mouseClicked = True\n        # Sキーでスクショ保存\n        elif event.type == pygame.KEYDOWN and event.key == pygame.K_s:\n            pygame.image.save(screen, \"screenshot.png\")\n            print(f\"Saved screenshot to screenshot.png.\")\n\n    # 2. 位置を更新\n    x += vx*dt\n    y += vy*dt\n\n    # 3. 速度を更新\n    vx += ax*dt\n    vy += ay*dt\n\n    # 4. 壁にぶつかったら，速度を反転させる\n    if x - r \u003c 0 and vx \u003c 0:\n        vx = -vx\n    elif x + r \u003e WIDTH and vx \u003e 0:\n        vx = -vx\n    if y - r \u003c 0 and vy \u003c 0:\n        vy = -vy\n    elif y + r \u003e HEIGHT and vy \u003e 0:\n        vy = -vy\n\n    # 5. 背景を塗る\n    screen.fill((220, 220, 220))  # R,G,B [0-255]\n\n    # 6. 図形を描く\n    # 赤い円を(x, y)の位置に描く．\n    pygame.draw.circle(screen, (255, 0, 0), (x, y), r)\n\n    # 7. 画面を更新\n    pygame.display.flip()\n\n    # 8. フレームレート制御 (1秒あたり60フレーム程度)\n    clock.tick(60)\n\n# 終了処理\npygame.quit()","position":{"start":{"line":15,"column":1},"end":{"line":92,"column":1}},"key":"N4VXF6ub8X"},{"type":"paragraph","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"children":[{"type":"text","value":"このプログラムを実行すると，ボールに見立てた赤い円が画面上を直線的に動き回り，またウィンドウの周囲では跳ね返る（跳ね返っているように運動の向きを変える）．どうしてそのように動作するのか，今後の改造に向けてプログラムの中身を理解しておこう．","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"key":"EPJMx14RQ6"}],"key":"taTJ8eA78e"},{"type":"container","kind":"figure","children":[{"type":"image","url":"https://akonno.github.io/FluidSeminarMaterials//build/screenshot3-1-8a46c52397cdd4dcc91823ee7249635e.png","alt":"ボールが跳ね返るプログラムを実行した例．ただしこの例では画面を完全には消さず，ボールの軌道がだんだん薄くなりながら画面に残るように表示している．ボールが直線的に動いていること，壁（ウィンドウの外枠）で跳ね返っていることが分かる．","align":"center","data":{"altTextIsAutoGenerated":true},"key":"Be5NgevETA","urlSource":"./images/media/screenshot3-1.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-ss3-1","identifier":"fig-ss3-1","html_id":"fig-ss3-1","enumerator":"71","children":[{"type":"text","value":"Figure ","key":"Jx2EU73bTE"},{"type":"text","value":"71","key":"SuS7T7UTt5"},{"type":"text","value":":","key":"UgDyUTEnAk"}],"template":"Figure %s:","key":"l5mSyWlwye"},{"type":"text","value":"ボールが跳ね返るプログラムを実行した例．ただしこの例では画面を完全には消さず，ボールの軌道がだんだん薄くなりながら画面に残るように表示している．ボールが直線的に動いていること，壁（ウィンドウの外枠）で跳ね返っていることが分かる．","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"TVGdyC1JRd"}],"key":"qDxAg97MLc"}],"key":"s4LB4j1OFj"}],"label":"fig-ss3-1","identifier":"fig-ss3-1","enumerator":"71","html_id":"fig-ss3-1","key":"Jv4f0oTLAE"},{"type":"admonition","kind":"important","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"ポイント","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"IVhkmnpFC2"}],"key":"fo5xqBqhZ3"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":103,"column":1},"end":{"line":118,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"text","value":"メインループ","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"GpP7hrPn1t"}],"key":"U6PEMxsi9o"},{"type":"text","value":"に入る前に，円の半径，初期位置，初速度，加速度が定義されている．ただしいまは加速度が","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"wEq9ekC4hq"},{"type":"inlineMath","value":"x","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ex\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"tnpQJY0ImO"},{"type":"text","value":"方向，","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"HeTvq3u4I8"},{"type":"inlineMath","value":"y","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ey\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"HnoFcCaZML"},{"type":"text","value":"方向ともに0なので，速度は壁にぶつからない限り一定のままである．","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"cfb8MB2jWf"}],"key":"hnPN3MRI31"}],"key":"LSFgGQnqWe"},{"type":"listItem","spread":true,"position":{"start":{"line":104,"column":1},"end":{"line":110,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"位置と速度は常微分方程式を数値的に解く最も基本的な方法である","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"Bgq5S7F0I6"},{"type":"strong","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"children":[{"type":"text","value":"オイラー陽解法","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"NcLmn77e9N"}],"key":"KevFTLJfUU"},{"type":"text","value":"で計算されている．すなわち，以下のようにして計算される．","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"hASIl1kbSF"}],"key":"ry9HEz3P83"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":105,"column":1},"end":{"line":110,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"x^{n+1} = x^n + v_x \\cdot dt","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003c/msup\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmsup\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/msup\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ev\u003c/mi\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/msub\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmi\u003et\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ex^{n+1} = x^n + v_x \\cdot dt\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8141em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003en\u003c/span\u003e\u003cspan class=\"mbin mtight\"\u003e+\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7477em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.6644em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.5945em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ev\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"zmcKR1XEWN"}],"key":"Rxg6HO7JUn"}],"key":"ypSyrPxVE2"},{"type":"listItem","spread":true,"position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"y^{n+1} = y^n + v_y \\cdot dt","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmi\u003ey\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003c/msup\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmsup\u003e\u003cmi\u003ey\u003c/mi\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/msup\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ev\u003c/mi\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/msub\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmi\u003et\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ey^{n+1} = y^n + v_y \\cdot dt\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0085em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003en\u003c/span\u003e\u003cspan class=\"mbin mtight\"\u003e+\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8588em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.6644em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7306em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ev\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"YFvcEBRPco"}],"key":"MbTzlqboLO"}],"key":"Q0MsOIiVp7"},{"type":"listItem","spread":true,"position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"v_x^{n+1} = v_x^n + a_x \\cdot dt","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsubsup\u003e\u003cmi\u003ev\u003c/mi\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003c/msubsup\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmsubsup\u003e\u003cmi\u003ev\u003c/mi\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/msubsup\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ea\u003c/mi\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/msub\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmi\u003et\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ev_x^{n+1} = v_x^n + a_x \\cdot dt\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0611em;vertical-align:-0.247em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ev\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003en\u003c/span\u003e\u003cspan class=\"mbin mtight\"\u003e+\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.247em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.9114em;vertical-align:-0.247em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ev\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.6644em;\"\u003e\u003cspan style=\"top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.247em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.5945em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ea\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"fmLVj4magn"}],"key":"WwurXl7xFs"}],"key":"niGEhclu1y"},{"type":"listItem","spread":true,"position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"v_y^{n+1} = v_y^n + a_y \\cdot dt","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsubsup\u003e\u003cmi\u003ev\u003c/mi\u003e\u003cmi\u003ey\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003c/msubsup\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmsubsup\u003e\u003cmi\u003ev\u003c/mi\u003e\u003cmi\u003ey\u003c/mi\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/msubsup\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ea\u003c/mi\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/msub\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmi\u003et\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ev_y^{n+1} = v_y^n + a_y \\cdot dt\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.1972em;vertical-align:-0.3831em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ev\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003en\u003c/span\u003e\u003cspan class=\"mbin mtight\"\u003e+\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3831em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0475em;vertical-align:-0.3831em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ev\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.6644em;\"\u003e\u003cspan style=\"top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3831em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7306em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ea\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003et\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"i1C92heWUr"}],"key":"c6YH05QSYm"}],"key":"tnDjW339mR"},{"type":"listItem","spread":true,"position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"ここでは上付き文字をタイムステップの意味で使っているので注意されたい．","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"Q5qsFyx76g"},{"type":"inlineMath","value":"x^n","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ex^n\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6644em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.6644em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"PJ6hx0ja8v"},{"type":"text","value":"は","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"uY9ZnNeXIv"},{"type":"inlineMath","value":"x","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ex\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"QurqOcrsRk"},{"type":"text","value":"の","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"VmkOMJe3D4"},{"type":"inlineMath","value":"n","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003en\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"jSS9u7D6ZZ"},{"type":"text","value":"乗ではなく，","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"L8TJqO0NR0"},{"type":"inlineMath","value":"n","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003en\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"CujpgKZrVD"},{"type":"text","value":"ステップ目での","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"U36IkgKp9D"},{"type":"inlineMath","value":"x","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ex\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"cudxlvGDCE"},{"type":"text","value":"座標を表す．","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"lKY1f3yHhm"}],"key":"Hz8nBmoKSL"}],"key":"eIDCxsvb3J"},{"type":"listItem","spread":true,"position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"オイラー陽解法は陽的オイラー法または単にオイラー法と呼ばれることもある．後で述べるがこの方法は精度が良くないので，改善が必要である．","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"OdLtpsOoHn"}],"key":"VGRKkTo7h2"}],"key":"dYVfKI2Qnc"}],"key":"R9hCrcd5Xx"}],"key":"Wg1FgRdUhH"},{"type":"listItem","spread":true,"position":{"start":{"line":111,"column":1},"end":{"line":118,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"壁にぶつかったことを壁からの距離と速度で判定している．たとえば左の壁に衝突した場合には，以下のように判定して速度を反転させる．","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"jKHN9KksiF"}],"key":"UaVbQmpzGY"},{"type":"code","lang":"python","value":"  if x - r \u003c 0 and vx \u003c 0:\n      vx = -vx","position":{"start":{"line":112,"column":1},"end":{"line":115,"column":1}},"key":"JzhQmLkvyr"},{"type":"paragraph","children":[{"type":"text","value":"つまり円の左端の位置が壁の位置よりも左になり（壁にめり込むことに相当），かつ，速度の","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"oGz3KUn6T4"},{"type":"inlineMath","value":"x","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ex\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"XXDXfADwpu"},{"type":"text","value":"方向成分が負だったら，速度の","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"X3UUhQyPNm"},{"type":"inlineMath","value":"x","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ex\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"qAlCfdcgat"},{"type":"text","value":"方向成分を反転させる．右および上下の壁も同様である．","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"qtsWXKilIS"}],"key":"xV4bTYmEyl"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":117,"column":1},"end":{"line":118,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"壁からの距離だけでなく速度も判定に使っているのは，計算上の誤差によりボールが壁にくっつくような動きになるのを抑えるためである．速度の評価をせず位置だけ見て速度を反転させると，一度壁で跳ね返ったあと（速度を反転させたあと）にまだ壁から近かった場合に，もういちど速度を反転させてしまうことがある．速度が壁に向かっているときだけ反転させれば，このような不具合は発生しないので，速度も見るようにする．","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"mCFis22LAv"}],"key":"ZGnsN1YykX"}],"key":"mso9H6ebhf"},{"type":"listItem","spread":true,"position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"壁では速度の符号を入れ替えているだけで，減衰は入れていない（速度の絶対値は変えていない）ので，完全弾性衝突（反発係数","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"SA6TueTrMP"},{"type":"inlineMath","value":"e=1","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ee\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ee=1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ee\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"BfVw9NHenT"},{"type":"text","value":"）に相当する衝突になっている．","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"Bx2WsEPVCL"}],"key":"ucdSefUnQZ"}],"key":"AImaejudAP"}],"key":"jK4TrFPmEa"}],"key":"TcFkHlvjgN"}],"key":"MajL1PTUR8"}],"key":"wU2furxwMe"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"演習課題","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"hiNCKgyfVD"}],"key":"kapt30I7hg"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":123,"column":1},"end":{"line":124,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"速度を変えてみよ．","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"mLWiRtsRDh"}],"key":"vfFAVPrjgH"}],"key":"FCSzOwpEhP"},{"type":"listItem","spread":true,"position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"ボールの色を変えてみよ．","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"Pc0IpV4796"}],"key":"JjW2ay5rTm"}],"key":"fh3PKx2GMR"}],"key":"YETWOekTFt"}],"class":"exercise","key":"xX10YG4v7U"},{"type":"heading","depth":2,"position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"重力の導入と計算精度向上","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"xBwm8k8bJI"}],"identifier":"id","label":"重力の導入と計算精度向上","html_id":"id-1","implicit":true,"key":"VLl1MIxYY0"},{"type":"paragraph","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"text","value":"重力のような効果を入れるため，","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"eR8IEKOFrF"},{"type":"inlineMath","value":"y","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ey\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"cANZIaSny4"},{"type":"text","value":"方向加速度を設定してみよう．","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"uY2l4FmxBN"}],"key":"PgkD7zsOLi"},{"type":"code","lang":"python","value":"ay = 0.5","position":{"start":{"line":131,"column":1},"end":{"line":133,"column":1}},"key":"sDplR1GWJh"},{"type":"paragraph","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"text","value":"PyGame-CEでは","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"lKc1yFECOV"},{"type":"inlineMath","value":"y","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ey\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"GSlz8mqdqj"},{"type":"text","value":"軸の正は下向きなので，","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"VjyDxwqMQm"},{"type":"inlineCode","value":"ay","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"iRxgSt3JLo"},{"type":"text","value":"に正の値を入れると画面上では下向きに加速する．つまり下向きの重力がはたらくことに相当する．（画面はピクセル単位で，物理空間とは単位が異なるため，","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"TDl5W2pDVz"},{"type":"inlineCode","value":"ay","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"l1UV3axi5x"},{"type":"text","value":"に重力加速度の正しい値を与えることはあまり意味が無く，適切なアニメーションになるような値を設定すれば良い．）","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"iKc1AXGcwz"}],"key":"Z4jqVJFy6t"},{"type":"paragraph","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"text","value":"このように変えると，ボールが地面で跳ね返るようなアニメーションが表示されることと思う．","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"hQI49W0aXG"}],"key":"FurKi3OuCc"},{"type":"paragraph","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"children":[{"type":"text","value":"ただしアニメーションをずっと表示し続けると，おそらくだんだんとボールの跳ね返る高さが高くなり，ついには天井にぶつかり，その後もだんだん速くなり続けるだろう．上に述べたように完全弾性衝突に当たる計算をしているから，正しく計算されていればずっと同じ高さまで跳ね返り続けるはずである．どうしてだんだん高くなるのだろうか?","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"X4CmaENJEt"}],"key":"NG0E7QcYRs"},{"type":"container","kind":"figure","children":[{"type":"image","url":"https://akonno.github.io/FluidSeminarMaterials//build/screenshot3-2-62852a854f443b7bc9a2a5b73835513f.png","alt":"ボールが跳ね返るプログラムを実行した例・重力あり．地面で跳ね返ったボールが放物線を描いて再び落下する様子や，跳ね返る高さがだんだん高くなる様子が分かる．","align":"center","data":{"altTextIsAutoGenerated":true},"key":"D4UuTE5URB","urlSource":"./images/media/screenshot3-2.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-ss3-2","identifier":"fig-ss3-2","html_id":"fig-ss3-2","enumerator":"72","children":[{"type":"text","value":"Figure ","key":"zApRnrHSTC"},{"type":"text","value":"72","key":"PIGpb3E7we"},{"type":"text","value":":","key":"K7uVoOExtw"}],"template":"Figure %s:","key":"YceUzStP0H"},{"type":"text","value":"ボールが跳ね返るプログラムを実行した例・重力あり．地面で跳ね返ったボールが放物線を描いて再び落下する様子や，跳ね返る高さがだんだん高くなる様子が分かる．","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"key":"KIBzZDY03r"}],"key":"bdNqmFiFOU"}],"key":"Z30lK3cCVx"}],"label":"fig-ss3-2","identifier":"fig-ss3-2","enumerator":"72","html_id":"fig-ss3-2","key":"fqxJgaKgNn"},{"type":"heading","depth":3,"position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"children":[{"type":"text","value":"位置の計算精度向上","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"zd2zHeqjCT"}],"identifier":"id","label":"位置の計算精度向上","html_id":"id-2","implicit":true,"key":"ORR0BH29EN"},{"type":"paragraph","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"children":[{"type":"text","value":"いまのプログラムでは，位置と速度は常微分方程式を数値的に解く最も基本的な方法であるオイラー陽解法で計算されているが，この解法は精度が良くない．速度は時間刻み","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"iHYtjvuFwW"},{"type":"inlineCode","value":"dt","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"F7NHF2Yzl6"},{"type":"text","value":"の間にだんだんと変化するはずだが，位置を計算するに際してはそのことを考慮せず，","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"gW6dNBNXev"},{"type":"inlineMath","value":"n","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003en\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"HKC2iWM7cs"},{"type":"text","value":"ステップ目での速度をそのまま用いて","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"lhUyTskoki"},{"type":"inlineMath","value":"n+1","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003en+1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"vLkY80BPuE"},{"type":"text","value":"ステップ目での位置を求めているからである．特に今回のように常に下向きに加速している場合は，","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"VaXaefoHkP"},{"type":"inlineMath","value":"y","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ey\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Tfj2qhTys5"},{"type":"text","value":"方向の速度が","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"fALvrgCJHL"},{"type":"inlineCode","value":"dt","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"yU2Lb2XeY3"},{"type":"text","value":"の間に相対的に下向きに変化することを無視しているので，どんどん高いほうにずれていく．","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"UOZPcJT48r"}],"key":"lkQ7QLu4Mv"},{"type":"paragraph","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"children":[{"type":"text","value":"これを改善する方法はいろいろ提案されているが，今回は加速度が一定であることを利用して位置の計算を改善しよう．","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"gQjAYXQrBv"}],"key":"zmVyS3bmWg"},{"type":"code","lang":"python","value":"    x += vx*dt + 0.5*ax*dt*dt\n    y += vy*dt + 0.5*ay*dt*dt","position":{"start":{"line":153,"column":1},"end":{"line":156,"column":1}},"key":"txJeslCTiy"},{"type":"paragraph","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"children":[{"type":"text","value":"このように","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"ZEz4gaUq0d"},{"type":"inlineMath","value":"x","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ex\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"RjYGQwV5DV"},{"type":"text","value":"と","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"Xe5YO7FAnr"},{"type":"inlineMath","value":"y","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ey\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"qLbcqgZbZv"},{"type":"text","value":"の計算に速度だけでなく，加速度も考慮する．この方法は加速度が一定の場合には解析解を与える．（高校物理または大学1年次の物理の授業で学んでいる式だと思われる．忘れていたら復習しよう．）","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"G5O1Gj3riR"}],"key":"jlgDC6T4Rm"},{"type":"container","kind":"figure","children":[{"type":"image","url":"https://akonno.github.io/FluidSeminarMaterials//build/screenshot3-3-b780c641f31ec8c293575a7e574291b3.png","alt":"ボールが跳ね返るプログラムを実行した例・重力あり，制度改善版．跳ね返る高さがほぼ一定になったことが分かる．","align":"center","data":{"altTextIsAutoGenerated":true},"key":"h4Z4JvvpDS","urlSource":"./images/media/screenshot3-3.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-ss3-3","identifier":"fig-ss3-3","html_id":"fig-ss3-3","enumerator":"73","children":[{"type":"text","value":"Figure ","key":"IaNXzLMUhd"},{"type":"text","value":"73","key":"FqS8O4BtrT"},{"type":"text","value":":","key":"kO7XygunUv"}],"template":"Figure %s:","key":"r56S8yLlQJ"},{"type":"text","value":"ボールが跳ね返るプログラムを実行した例・重力あり，制度改善版．跳ね返る高さがほぼ一定になったことが分かる．","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"SFONo69mJn"}],"key":"vLARAqSfXI"}],"key":"IsGV8x0Fh4"}],"label":"fig-ss3-3","identifier":"fig-ss3-3","enumerator":"73","html_id":"fig-ss3-3","key":"d3fLJSNdUJ"},{"type":"heading","depth":2,"position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"children":[{"type":"text","value":"衝突の判定の拡張・長方形との衝突","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"d0SEmVoWXu"}],"identifier":"id","label":"衝突の判定の拡張・長方形との衝突","html_id":"id-3","implicit":true,"key":"dnEnx3SUFA"},{"type":"paragraph","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"children":[{"type":"text","value":"壁以外のものとの衝突を導入しよう．たとえば長方形を画面上に描き，それと衝突したら跳ね返るようにする．","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"key":"EoUgQjNmKv"}],"key":"t0c0tKsqwl"},{"type":"paragraph","position":{"start":{"line":170,"column":1},"end":{"line":171,"column":1}},"children":[{"type":"text","value":"長方形は画面の端に平行に置き，その領域は左上の座標","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"TkA85B1o2x"},{"type":"inlineMath","value":"(x_{ul}, y_{ul})","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmi\u003el\u003c/mi\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ey\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003eu\u003c/mi\u003e\u003cmi\u003el\u003c/mi\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e(x_{ul}, y_{ul})\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003eu\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\"\u003el\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003eu\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\"\u003el\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"rMBv8fJEhn"},{"type":"text","value":"と右下の座標","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"wwxvpbI2Ff"},{"type":"inlineMath","value":"(x_{lr}, y_{lr})","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003el\u003c/mi\u003e\u003cmi\u003er\u003c/mi\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ey\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003el\u003c/mi\u003e\u003cmi\u003er\u003c/mi\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e(x_{lr}, y_{lr})\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\"\u003el\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\"\u003er\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\"\u003el\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\"\u003er\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"GDY8LJkxxa"},{"type":"text","value":"で表すこととする．はじめは固定座標としよう．\n（ul, lrはそれぞれupper left, lower rightの意味）","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"Ul3ELLZLTr"}],"key":"aNL0MShJRZ"},{"type":"code","lang":"python","value":"# 長方形を配置\nx_ul = 150  # 左上のx座標\ny_ul = 250  # 左上のy座標\nx_lr = 300  # 右下のx座標\ny_lr = 270  # 右下のy座標","position":{"start":{"line":173,"column":1},"end":{"line":179,"column":1}},"key":"XSoQ45ojgB"},{"type":"paragraph","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"そしてメインループの中で，長方形ボール（円）が衝突したら跳ね返るようにしよう．","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"e3XpOTgVvW"}],"key":"oaazMi18ct"},{"type":"code","lang":"python","value":"    # 4b. 長方形にぶつかったら，速度を反転させる．\n    # 簡易版\n    # 長方形の左辺にぶつかった場合\n    if vx \u003e 0 and x + r \u003e= x_ul and x - r \u003c x_ul:\n        if y + r \u003e= y_ul and y - r \u003c= y_lr:\n            vx = -vx\n            x = x_ul - r\n    \n    # 長方形の右辺にぶつかった場合\n    if vx \u003c 0 and x - r \u003c= x_lr and x + r \u003e x_lr:\n        if y + r \u003e= y_ul and y - r \u003c= y_lr:\n            vx = -vx\n            x = x_lr + r\n    \n    # 長方形の上辺にぶつかった場合\n    if vy \u003e 0 and y + r \u003e= y_ul and y - r \u003c y_ul:\n        if x + r \u003e= x_ul and x - r \u003c= x_lr:\n            vy = -vy\n            y = y_ul - r\n    \n    # 長方形の下辺にぶつかった場合\n    if vy \u003c 0 and y - r \u003c= y_lr and y + r \u003e y_lr:\n        if x + r \u003e= x_ul and x - r \u003c= x_lr:\n            vy = -vy\n            y = y_lr + r","position":{"start":{"line":183,"column":1},"end":{"line":209,"column":1}},"key":"rXxtyrSGvd"},{"type":"container","kind":"figure","children":[{"type":"image","url":"https://akonno.github.io/FluidSeminarMaterials//build/screenshot3-4-3a7b82a6434215216641400e17826d2d.png","alt":"ボールが壁面および配置された長方形と衝突すると跳ね返るプログラムを実行した例・重力あり","align":"center","data":{"altTextIsAutoGenerated":true},"key":"q33EcPIUio","urlSource":"./images/media/screenshot3-4.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-ss3-4","identifier":"fig-ss3-4","html_id":"fig-ss3-4","enumerator":"74","children":[{"type":"text","value":"Figure ","key":"qVu8FNhKDn"},{"type":"text","value":"74","key":"PKqq76ZoLG"},{"type":"text","value":":","key":"zSEE65cVgl"}],"template":"Figure %s:","key":"mOfRsHXi0j"},{"type":"text","value":"ボールが壁面および配置された長方形と衝突すると跳ね返るプログラムを実行した例・重力あり","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"wVc7WmfuqB"}],"key":"PmPv6DF4Nx"}],"key":"gNXCoLVmz4"}],"label":"fig-ss3-4","identifier":"fig-ss3-4","enumerator":"74","html_id":"fig-ss3-4","key":"PVLowMfkmw"},{"type":"heading","depth":2,"position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"children":[{"type":"text","value":"マウスの動きに合わせて長方形を動かす","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"Zf906WLGEm"}],"identifier":"id","label":"マウスの動きに合わせて長方形を動かす","html_id":"id-4","implicit":true,"key":"tUBnCAmd8L"},{"type":"paragraph","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"children":[{"type":"text","value":"長方形が固定のままだと発展性がないので，マウスの動きに合わせて長方形が動くようにしてみよう．","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"payeePoPrt"}],"key":"AeNrUAn65f"},{"type":"paragraph","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"children":[{"type":"text","value":"以前の教材で学んだように，マウスカーソルの位置は","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"key":"HKu2I6D55b"},{"type":"inlineCode","value":"mx, my = pygame.mouse.get_pos()","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"key":"WI3lSCuZOB"},{"type":"text","value":"で得られるので，長方形の位置をそれに合わせて動かす．今回は長方形の高さは固定し，横方向にのみ動かしてみる．","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"key":"ELApLZAv6k"}],"key":"icBzKtm3iO"},{"type":"code","lang":"python","value":"    # マウス位置を取得\n    mx, my = pygame.mouse.get_pos()\n\n    # マウスの位置に合わせて長方形の位置を変える\n    x_ul = mx - 50\n    x_lr = mx + 50","position":{"start":{"line":223,"column":1},"end":{"line":230,"column":1}},"key":"TSl4tUNCGa"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"演習課題","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"key":"Egn4cLwQ4R"}],"key":"TysJHaW5cQ"},{"type":"paragraph","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"children":[{"type":"text","value":"上のコードをプログラムのどこに入れれば良いか? 適切な場所に入れて，マウスの動きに合わせて長方形が動くようにせよ．","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"key":"rb3nQOaoeC"}],"key":"Sb2CdN9Nab"}],"class":"exercise","key":"kCvBUVVwbq"},{"type":"container","kind":"figure","children":[{"type":"image","url":"https://akonno.github.io/FluidSeminarMaterials//build/screenshot3-5-4e72506b24e0c8ba5a52d09b48f1caeb.png","alt":"ボールが壁面および配置された長方形と衝突すると跳ね返るプログラムを実行した例・長方形がマウスの動きに合わせて横移動する場合","align":"center","data":{"altTextIsAutoGenerated":true},"key":"QEFyNrBJht","urlSource":"./images/media/screenshot3-5.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-ss3-5","identifier":"fig-ss3-5","html_id":"fig-ss3-5","enumerator":"75","children":[{"type":"text","value":"Figure ","key":"JHHC1wPBkp"},{"type":"text","value":"75","key":"nbBKly9Ym9"},{"type":"text","value":":","key":"LqmpW87IVt"}],"template":"Figure %s:","key":"Ugmvzm4yrG"},{"type":"text","value":"ボールが壁面および配置された長方形と衝突すると跳ね返るプログラムを実行した例・長方形がマウスの動きに合わせて横移動する場合","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"key":"PUvsAXTZPp"}],"key":"fRcAk2Qjgs"}],"key":"oxI1KyAdbd"}],"label":"fig-ss3-5","identifier":"fig-ss3-5","enumerator":"75","html_id":"fig-ss3-5","key":"AeYnUfRbrC"},{"type":"heading","depth":2,"position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"children":[{"type":"text","value":"発展：衝突判定の改善","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"Qd0YPfLn6C"}],"identifier":"id","label":"発展：衝突判定の改善","html_id":"id-5","implicit":true,"key":"tM9tIUyZUn"},{"type":"paragraph","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"children":[{"type":"text","value":"現在の衝突のコードは判定が簡略化されており，特に長方形の角にボールが近づいた場合には実際に衝突する前に跳ね返る．また跳ね返る方向は常に衝突した方向の真逆である．これをより現実的な衝突に変更したい．","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"key":"VgounNJDOr"}],"key":"FYv8zbodoB"},{"type":"container","kind":"figure","children":[{"type":"image","url":"https://akonno.github.io/FluidSeminarMaterials//build/screenshot3-6-289e49eee58c9d98d1ca2c27cdade7dc.png","alt":"ボールが壁面および配置された長方形と衝突すると跳ね返るプログラムで，ボールが長方形の左上隅に「衝突」している例．実際にはボールと長方形とは接触しておらず，また衝突前と速度が反転していることが分かる．","align":"center","data":{"altTextIsAutoGenerated":true},"key":"uWq9wOBzTS","urlSource":"./images/media/screenshot3-6.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-ss3-6","identifier":"fig-ss3-6","html_id":"fig-ss3-6","enumerator":"76","children":[{"type":"text","value":"Figure ","key":"y1S7tuwltv"},{"type":"text","value":"76","key":"BhL9vGTL2u"},{"type":"text","value":":","key":"S4Ne7nVNXD"}],"template":"Figure %s:","key":"GWHdcAPaNt"},{"type":"text","value":"ボールが壁面および配置された長方形と衝突すると跳ね返るプログラムで，ボールが長方形の左上隅に「衝突」している例．実際にはボールと長方形とは接触しておらず，また衝突前と速度が反転していることが分かる．","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"key":"qb3zPejOVq"}],"key":"U7Qmxl8E8O"}],"key":"arhQwhnNyQ"}],"label":"fig-ss3-6","identifier":"fig-ss3-6","enumerator":"76","html_id":"fig-ss3-6","key":"lTxwKIDhLp"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"演習課題","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"ATwapo306i"}],"key":"kFebGLOuRS"},{"type":"paragraph","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"children":[{"type":"text","value":"先ほど作成したプログラムを用い，実際に長方形の角にボールをぶつけてみて，どのように跳ね返るか確認せよ．","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"bnMQLwRPeq"}],"key":"wbblewbD9Z"}],"class":"exercise","key":"It5vdtFtGd"},{"type":"paragraph","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"children":[{"type":"text","value":"衝突を改善するにあたり，まずボールの位置によって衝突判定を","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"LATCbLTVJC"},{"type":"crossReference","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"children":[{"type":"text","value":"Figure ","key":"M8l23YEpAP"},{"type":"text","value":"77","key":"ViOoXVM1te"}],"identifier":"fig-collision-rectangle","label":"fig-collision-rectangle","kind":"figure","template":"Figure %s","enumerator":"77","resolved":true,"html_id":"fig-collision-rectangle","key":"duqGVYYd3m"},{"type":"text","value":"のように8通りに分類する．","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"JqxB32b8MK"}],"key":"NDQNpx1EVj"},{"type":"container","kind":"figure","children":[{"type":"image","url":"https://akonno.github.io/FluidSeminarMaterials//build/collision-rectangle.-00a44734bfc28f9e5ed3adf20fa6aece.png","alt":"ボールと長方形との衝突の場合分け．ボールの中心が長方形まわりのどの位置にあるかによって，衝突判定を8通りに分類する．","align":"center","data":{"altTextIsAutoGenerated":true},"key":"wZNQbwiUuP","urlSource":"./images/collision-rectangle.drawio.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-collision-rectangle","identifier":"fig-collision-rectangle","html_id":"fig-collision-rectangle","enumerator":"77","children":[{"type":"text","value":"Figure ","key":"sewWHIjxyx"},{"type":"text","value":"77","key":"wAlbSpzPdX"},{"type":"text","value":":","key":"WOSRfj5vGA"}],"template":"Figure %s:","key":"qnVAlmovCz"},{"type":"text","value":"ボールと長方形との衝突の場合分け．ボールの中心が長方形まわりのどの位置にあるかによって，衝突判定を8通りに分類する．","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"key":"EUVmI0VcJb"}],"key":"P2iozXTfRC"}],"key":"tMAQDsLS7z"}],"label":"fig-collision-rectangle","identifier":"fig-collision-rectangle","enumerator":"77","html_id":"fig-collision-rectangle","key":"AsQTOgdS1b"},{"type":"paragraph","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"children":[{"type":"text","value":"ボールの中心が①～④のいずれかにある場合の衝突判定と跳ね返りは，以前に示した衝突と同じように扱う．ボールの中心が⑤～⑧のいずれかにある場合は，長方形の角に衝突するものとして取り扱う．","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"h3H3pQ1uT8"}],"key":"wGLzZarcWF"},{"type":"paragraph","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"children":[{"type":"text","value":"ここでは長方形の角に当たった場合には，角に向かって心向き直衝突しているものと考える．つまり角からボールの中心に向かうベクトルを考えたとき，角の位置にはこのベクトルと垂直な壁があり，これと衝突し跳ね返ると考える．従って速度の角→ボール中心向きの成分を取りだし，それを反転させる．","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"WxLn3bfLgD"}],"key":"kKhaT8lJJ0"},{"type":"paragraph","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"children":[{"type":"text","value":"角→ボール中心に向かうベクトルは，","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"B1P7F0TZ9M"}],"key":"stzJInpHWq"},{"type":"math","value":"\\boldsymbol{n}=(x-x_{c}, y-y_{c})","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold-italic\"\u003en\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmi\u003ec\u003c/mi\u003e\u003c/msub\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmi\u003ey\u003c/mi\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ey\u003c/mi\u003e\u003cmi\u003ec\u003c/mi\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\boldsymbol{n}=(x-x_{c}, y-y_{c})\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord boldsymbol\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7778em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ec\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ec\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"1","key":"PZZnnLaV2w"},{"type":"paragraph","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"children":[{"type":"text","value":"と書ける．ここで","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"RU2qdIDgb9"},{"type":"inlineMath","value":"(x_c, y_c)","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmi\u003ec\u003c/mi\u003e\u003c/msub\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ey\u003c/mi\u003e\u003cmi\u003ec\u003c/mi\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e(x_c, y_c)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ec\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ec\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"W6tAKBVtcH"},{"type":"text","value":"は角の座標である．","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"CM0l5gbx8y"}],"key":"bw6UfhACRu"},{"type":"paragraph","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"children":[{"type":"text","value":"このベクトルの長さが円の半径","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"key":"OnnpPYv2FO"},{"type":"inlineMath","value":"r","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003er\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003er\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003er\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"oATD188dwK"},{"type":"text","value":"以下のとき，角と衝突している．以下の式では","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"key":"V9nHdaHYEj"},{"type":"inlineMath","value":"n","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003en\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"XyaKXWqDPl"},{"type":"text","value":"（太字でない","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"key":"UNhlX8AGCI"},{"type":"inlineMath","value":"n","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003en\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"vsrNaX8u3P"},{"type":"text","value":"）を","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"key":"xKpX76H7Vh"},{"type":"inlineMath","value":"\\boldsymbol{n}","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold-italic\"\u003en\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\boldsymbol{n}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord boldsymbol\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"kjFFkSmeJl"},{"type":"text","value":"（太字の","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"key":"FPAkqHIO9y"},{"type":"inlineMath","value":"\\boldsymbol{n}","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold-italic\"\u003en\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\boldsymbol{n}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord boldsymbol\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"o9j3NRPSl7"},{"type":"text","value":"，ベクトルを表す）の大きさの意味で使っている．","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"key":"VKDjLzoUWf"}],"key":"neKDJBjDvK"},{"type":"math","value":"n^2=(x-x_c)^2+(y-y_c)^2\\leq r^2","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmi\u003ec\u003c/mi\u003e\u003c/msub\u003e\u003cmsup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003ey\u003c/mi\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ey\u003c/mi\u003e\u003cmi\u003ec\u003c/mi\u003e\u003c/msub\u003e\u003cmsup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003cmo\u003e≤\u003c/mo\u003e\u003cmsup\u003e\u003cmi\u003er\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003en^2=(x-x_c)^2+(y-y_c)^2\\leq r^2\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8641em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8641em;\"\u003e\u003cspan style=\"top:-3.113em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ec\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8641em;\"\u003e\u003cspan style=\"top:-3.113em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ec\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8641em;\"\u003e\u003cspan style=\"top:-3.113em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e≤\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8641em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003er\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8641em;\"\u003e\u003cspan style=\"top:-3.113em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"2","key":"LZyFSmous4"},{"type":"paragraph","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"children":[{"type":"text","value":"今後の計算のため，法線ベクトル","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"key":"Pw8bUSouZd"},{"type":"inlineMath","value":"\\boldsymbol{n}","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold-italic\"\u003en\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\boldsymbol{n}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord boldsymbol\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"DypXxCconW"},{"type":"text","value":"を単位法線ベクトルに変換したものを作る．","position":{"start":{"line":280,"column":1},"end":{"line":280,"column":1}},"key":"UZLUmGlehY"}],"key":"plx2wx7wJl"},{"type":"math","value":"\\hat{\\boldsymbol{n}}=\\frac{\\boldsymbol{n}}{n}","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmover accent=\"true\"\u003e\u003cmi mathvariant=\"bold-italic\"\u003en\u003c/mi\u003e\u003cmo\u003e^\u003c/mo\u003e\u003c/mover\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmfrac\u003e\u003cmi mathvariant=\"bold-italic\"\u003en\u003c/mi\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/mfrac\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\hat{\\boldsymbol{n}}=\\frac{\\boldsymbol{n}}{n}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7079em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7079em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord boldsymbol\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.0134em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.25em;\"\u003e\u003cspan class=\"mord\"\u003e^\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.8074em;vertical-align:-0.686em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.1214em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord boldsymbol\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"3","key":"l1935joz08"},{"type":"paragraph","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"children":[{"type":"text","value":"現在の速度を","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"y5R5EGaIzS"},{"type":"inlineMath","value":"(v_x, v_y)","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ev\u003c/mi\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/msub\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ev\u003c/mi\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e(v_x, v_y)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ev\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ev\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"tYMbP5eMeJ"},{"type":"text","value":"とすると，法線方向成分はこれと","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"aMrm70uQTE"},{"type":"inlineMath","value":"\\hat{\\boldsymbol{n}}","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmover accent=\"true\"\u003e\u003cmi mathvariant=\"bold-italic\"\u003en\u003c/mi\u003e\u003cmo\u003e^\u003c/mo\u003e\u003c/mover\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\hat{\\boldsymbol{n}}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7079em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7079em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord boldsymbol\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.0134em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.25em;\"\u003e\u003cspan class=\"mord\"\u003e^\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"UfF8Q2vNmG"},{"type":"text","value":"との内積で求められる．","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"pwN4f3QA9E"}],"key":"il1vKuBICb"},{"type":"math","value":"v_n = \\boldsymbol{v}\\cdot\\hat{\\boldsymbol{n}}=v_x\\hat{n}_x+v_y\\hat{n}_y","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003ev\u003c/mi\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/msub\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi mathvariant=\"bold-italic\"\u003ev\u003c/mi\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmover accent=\"true\"\u003e\u003cmi mathvariant=\"bold-italic\"\u003en\u003c/mi\u003e\u003cmo\u003e^\u003c/mo\u003e\u003c/mover\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ev\u003c/mi\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/msub\u003e\u003cmsub\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmo\u003e^\u003c/mo\u003e\u003c/mover\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/msub\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ev\u003c/mi\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/msub\u003e\u003cmsub\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmo\u003e^\u003c/mo\u003e\u003c/mover\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ev_n = \\boldsymbol{v}\\cdot\\hat{\\boldsymbol{n}}=v_x\\hat{n}_x+v_y\\hat{n}_y\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ev\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4445em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord boldsymbol\" style=\"margin-right:0.03704em;\"\u003ev\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7079em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7079em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord boldsymbol\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.0134em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.25em;\"\u003e\u003cspan class=\"mord\"\u003e^\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ev\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.6944em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.25em;\"\u003e\u003cspan class=\"mord\"\u003e^\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ev\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.6944em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.25em;\"\u003e\u003cspan class=\"mord\"\u003e^\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"4","key":"se5NuXL1kC"},{"type":"paragraph","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"children":[{"type":"text","value":"もし","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"CkebR38uUY"},{"type":"inlineMath","value":"v_n\\geq 0","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003ev\u003c/mi\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/msub\u003e\u003cmo\u003e≥\u003c/mo\u003e\u003cmn\u003e0\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ev_n\\geq 0\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.786em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ev\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e≥\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"DSwUzj9g4J"},{"type":"text","value":"なら，ボールは角から離れる方向に動いているので，速度は変えなくてよい．","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"N2eiUfRCu1"},{"type":"inlineMath","value":"v_n\u003c0","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003ev\u003c/mi\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/msub\u003e\u003cmo\u003e\u0026lt;\u003c/mo\u003e\u003cmn\u003e0\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ev_n\u0026lt;0\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6891em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ev\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"o7le8Ixwrd"},{"type":"text","value":"ならボールは角に向かって動いているので，その成分だけ反転させる．","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"MqJC4xLEN1"}],"key":"qAbTrbD5Md"},{"type":"math","value":"\\boldsymbol{v}'=\\boldsymbol{v}-2v_n\\hat{\\boldsymbol{n}}","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmi mathvariant=\"bold-italic\"\u003ev\u003c/mi\u003e\u003cmo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\"\u003e′\u003c/mo\u003e\u003c/msup\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi mathvariant=\"bold-italic\"\u003ev\u003c/mi\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmn\u003e2\u003c/mn\u003e\u003cmsub\u003e\u003cmi\u003ev\u003c/mi\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/msub\u003e\u003cmover accent=\"true\"\u003e\u003cmi mathvariant=\"bold-italic\"\u003en\u003c/mi\u003e\u003cmo\u003e^\u003c/mo\u003e\u003c/mover\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\boldsymbol{v}\u0026#x27;=\\boldsymbol{v}-2v_n\\hat{\\boldsymbol{n}}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8019em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord boldsymbol\" style=\"margin-right:0.03704em;\"\u003ev\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8019em;\"\u003e\u003cspan style=\"top:-3.113em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e′\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord boldsymbol\" style=\"margin-right:0.03704em;\"\u003ev\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8579em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e2\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ev\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7079em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord boldsymbol\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.0134em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.25em;\"\u003e\u003cspan class=\"mord\"\u003e^\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"5","key":"eUu0FuXDX9"},{"type":"paragraph","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"children":[{"type":"text","value":"これにより角→ボール中心方向成分のみ符号が変わり，接線方向（角→ボール中心方向と垂直な成分）は維持される．","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"key":"rrDwq55p6F"}],"key":"VQbifCtN2R"},{"type":"paragraph","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"children":[{"type":"text","value":"ここで検討した計算方法を，Pythonの関数にしよう．","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"qR7LijxB9N"}],"key":"psNwKEuOaH"},{"type":"code","lang":"python","value":"import math\n\ndef collide_circle_corner(x, y, r, vx, vy, x_c, y_c):\n    \"\"\"\n    ボール（中心 x, y, 半径 r）と、長方形の角 (x_c, y_c) の衝突を判定し、\n    ボールが角に向かっている場合は速度ベクトルを反射させる。\n\n    返り値: (vx_new, vy_new)\n    \"\"\"\n\n    # 角 → ボール中心のベクトル\n    dx = x - x_c\n    dy = y - y_c\n\n    dist = math.sqrt(dx*dx + dy*dy)\n\n    # 衝突はすでに判定済みとする．（dist \u003c= r のときに呼び出される想定）\n\n    # 単位法線ベクトル（角 → ボール中心）\n    nx = dx / dist\n    ny = dy / dist\n\n    # 法線方向速度成分 v_n を求める\n    v_n = vx * nx + vy * ny  # 法線方向速度成分 v_n\n\n    # v_n \u003c 0 のときだけ「角に向かっている」ので反射させる\n    if v_n \u003c 0:\n        # 反射: v' = v - 2 (v・n) n\n        vx -= 2.0 * v_n * nx\n        vy -= 2.0 * v_n * ny\n\n    return vx, vy","position":{"start":{"line":296,"column":1},"end":{"line":329,"column":1}},"key":"DLzqbvmhjr"},{"type":"paragraph","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"children":[{"type":"text","value":"そして，⑤～⑧の場合はこの関数を使って衝突後の速度を求める．","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"key":"aajnWDJ2OD"}],"key":"N9XfXlFxcm"},{"type":"code","lang":"python","value":"    # ①左辺にぶつかった場合\n    if x \u003c x_ul and y_ul \u003c= y and y \u003c= y_lr and x + r \u003e= x_ul and vx \u003e 0:\n        vx = -vx\n    # ②右辺にぶつかった場合\n    elif x \u003e x_lr and y_ul \u003c= y and y \u003c= y_lr and x - r \u003c= x_lr and vx \u003c 0:\n        vx = -vx\n    # ③上辺にぶつかった場合\n    elif y \u003c y_ul and x_ul \u003c= x and x \u003c= x_lr and y + r \u003e= y_ul and vy \u003e 0:\n        vy = -vy\n    # ④下辺にぶつかった場合\n    elif y \u003e y_lr and x_ul \u003c= x and x \u003c= x_lr and y - r \u003c= y_lr and vy \u003c 0:\n        vy = -vy\n    # ⑤左上隅にぶつかった場合\n    elif x \u003c x_ul and y \u003c y_ul and (x - x_ul)**2 + (y - y_ul)**2 \u003c= r**2:\n        vx, vy = collide_circle_corner(x, y, r, vx, vy, x_ul, y_ul)\n    # ⑥右上隅にぶつかった場合\n    elif x \u003e x_lr and y \u003c y_ul and (x - x_lr)**2 + (y - y_ul)**2 \u003c= r**2:\n        vx, vy = collide_circle_corner(x, y, r, vx, vy, x_lr, y_ul)\n    # ⑦左下隅にぶつかった場合\n    elif x \u003c x_ul and y \u003e y_lr and (x - x_ul)**2 + (y - y_lr)**2 \u003c= r**2:\n        vx, vy = collide_circle_corner(x, y, r, vx, vy, x_ul, y_lr)\n    # ⑧右下隅にぶつかった場合\n    elif x \u003e x_lr and y \u003e y_lr and (x - x_lr)**2 + (y - y_lr)**2 \u003c= r**2:\n        vx, vy = collide_circle_corner(x, y, r, vx, vy, x_lr, y_lr)","position":{"start":{"line":333,"column":1},"end":{"line":358,"column":1}},"key":"SFrpd3dMw7"},{"type":"container","kind":"figure","children":[{"type":"image","url":"https://akonno.github.io/FluidSeminarMaterials//build/screenshot3-7-d5784260980b5f6365f0533230b3ba3d.png","alt":"ボールと長方形との角の衝突を改善した例．なおボールが角にぶつかりやすいように，ボールの半径を大きくしている．ボールが長方形の右上隅に衝突して速度ベクトルの向きが変わっていることが分かる．","align":"center","data":{"altTextIsAutoGenerated":true},"key":"LR9C9sXYiN","urlSource":"./images/media/screenshot3-7.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":363,"column":1},"end":{"line":363,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-ss3-7","identifier":"fig-ss3-7","html_id":"fig-ss3-7","enumerator":"78","children":[{"type":"text","value":"Figure ","key":"Y51ZIFpbB6"},{"type":"text","value":"78","key":"LtQh68yw3p"},{"type":"text","value":":","key":"OOPAlD68tm"}],"template":"Figure %s:","key":"BQ0YeSXlNB"},{"type":"text","value":"ボールと長方形との角の衝突を改善した例．なおボールが角にぶつかりやすいように，ボールの半径を大きくしている．ボールが長方形の右上隅に衝突して速度ベクトルの向きが変わっていることが分かる．","position":{"start":{"line":363,"column":1},"end":{"line":363,"column":1}},"key":"wYXRtMpTE4"}],"key":"FDQMlpWVM0"}],"key":"wkygANjbub"}],"label":"fig-ss3-7","identifier":"fig-ss3-7","enumerator":"78","html_id":"fig-ss3-7","key":"aelUzFtX1e"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"演習課題","position":{"start":{"line":366,"column":1},"end":{"line":366,"column":1}},"key":"AgRdSgYdVU"}],"key":"t52bJaC8x2"},{"type":"paragraph","position":{"start":{"line":368,"column":1},"end":{"line":368,"column":1}},"children":[{"type":"text","value":"ここまで検討した内容を用いて，長方形の角での衝突を改善せよ．","position":{"start":{"line":368,"column":1},"end":{"line":368,"column":1}},"key":"xJdDQ8PMXl"}],"key":"d7OIV6QJTO"}],"class":"exercise","key":"WCZByMQWfA"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"演習課題（発展）","position":{"start":{"line":371,"column":1},"end":{"line":371,"column":1}},"key":"OKYuC0nO4R"}],"key":"nV7XrXzb6Y"},{"type":"paragraph","position":{"start":{"line":373,"column":1},"end":{"line":373,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":373,"column":1},"end":{"line":373,"column":1}},"children":[{"type":"text","value":"Figure ","key":"FvQeaTjZ35"},{"type":"text","value":"78","key":"CnUnyfXl3B"}],"identifier":"fig-ss3-7","label":"fig-ss3-7","kind":"figure","template":"Figure %s","enumerator":"78","resolved":true,"html_id":"fig-ss3-7","key":"ZPjplE1E4g"},{"type":"text","value":"では，長方形に少し食い込んでいるように見える．これはなぜか? またプログラムを改変して，ボールが長方形に食い込まないようにせよ．ただし「ボールを小さくする」のと「ボールの動きをゆっくりにする」のは除外し，いまと同様の速度でボールが動きつつ，衝突計算精度を向上させよ．","position":{"start":{"line":373,"column":1},"end":{"line":373,"column":1}},"key":"pd0pvdAhZJ"}],"key":"M23fNNV588"}],"class":"exercise","key":"oq1kXgTztg"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"演習課題（発展）","position":{"start":{"line":376,"column":1},"end":{"line":376,"column":1}},"key":"Z8m8hpGCka"}],"key":"CRsxVfk2Cx"},{"type":"paragraph","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"children":[{"type":"text","value":"長方形をマウスで動かす場合において，長方形を動かす速度が衝突後の反発に影響するようにせよ．端的には衝突時の相対速度を考慮し，それによって衝突後の速度が変わるようにせよ．","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"LNiK2v7Awb"}],"key":"X4DXliPjc1"}],"class":"exercise","key":"qo1FXZ2XbA"},{"type":"heading","depth":2,"position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"children":[{"type":"text","value":"障害物くぐりゲーム（Flappy Bird風）","position":{"start":{"line":381,"column":1},"end":{"line":381,"column":1}},"key":"BMtrQ5zX6P"}],"identifier":"id-flappy-bird","label":"障害物くぐりゲーム（Flappy Bird風）","html_id":"id-flappy-bird","implicit":true,"key":"MVYZ0NKgKB"},{"type":"paragraph","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"children":[{"type":"text","value":"Flappy Bird風の障害物くぐりゲームを作ろう．ボールを壁や長方形に衝突しないように操作し，衝突したらゲームオーバーとする．","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"key":"EFnYSnZ4p1"}],"key":"B9iSc98hsm"},{"type":"heading","depth":3,"position":{"start":{"line":385,"column":1},"end":{"line":385,"column":1}},"children":[{"type":"text","value":"マウスのクリックに応じて動きを変える","position":{"start":{"line":385,"column":1},"end":{"line":385,"column":1}},"key":"ILje6Td073"}],"identifier":"id","label":"マウスのクリックに応じて動きを変える","html_id":"id-6","implicit":true,"key":"pT48Y8FAEN"},{"type":"paragraph","position":{"start":{"line":387,"column":1},"end":{"line":387,"column":1}},"children":[{"type":"text","value":"はじめに，ボールが","position":{"start":{"line":387,"column":1},"end":{"line":387,"column":1}},"key":"mbqS4v19uR"},{"type":"inlineMath","value":"y","position":{"start":{"line":387,"column":1},"end":{"line":387,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ey\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Sko6S2VLxC"},{"type":"text","value":"軸方向にのみ動くようにし，またマウスをクリックしている間は上向きに，クリックしていないときは下向きに動くようにしよう．長方形はいったん消す．","position":{"start":{"line":387,"column":1},"end":{"line":387,"column":1}},"key":"RkUicSRlIf"}],"key":"w0pzE9CFFm"},{"type":"code","lang":"python","value":"    if mouseClicked:\n        vy = -2\n    else:\n        vy = 2\n    \n    # 2. 位置（yのみ）を更新（加速度は使わない）\n    y += vy*dt","position":{"start":{"line":389,"column":1},"end":{"line":397,"column":1}},"key":"AOWP7WhCTs"},{"type":"paragraph","position":{"start":{"line":399,"column":1},"end":{"line":399,"column":1}},"children":[{"type":"text","value":"これで，マウスをクリックしているときは上向き，クリックしていないときは下向きにボールが動くはずである．","position":{"start":{"line":399,"column":1},"end":{"line":399,"column":1}},"key":"CwDQKLSS88"}],"key":"rDLC9XZGBx"},{"type":"heading","depth":3,"position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"children":[{"type":"text","value":"衝突判定の拡張：複数の長方形と衝突判定","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"key":"g8P5rQs8YB"}],"identifier":"id","label":"衝突判定の拡張：複数の長方形と衝突判定","html_id":"id-7","implicit":true,"key":"VzSQRzLhMG"},{"type":"paragraph","position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"children":[{"type":"text","value":"障害物として複数の長方形が画面に現れ，右から左に向かって動くようにしよう．そのためには複数の長方形を扱う必要があるので，「長方形との衝突」を扱う関数を作ろう．","position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"key":"U1kigiScad"}],"key":"HCoDDt7fBf"},{"type":"code","lang":"python","value":"\ndef collision_test(x, y, r, x_ul, y_ul, x_lr, y_lr):\n    \"\"\"円と矩形の衝突判定（詳細版）\"\"\"\n    # ①左辺にぶつかった場合\n    if x \u003c x_ul and y_ul \u003c= y and y \u003c= y_lr and x + r \u003e= x_ul:\n        return True\n    # ②右辺にぶつかった場合\n    elif x \u003e x_lr and y_ul \u003c= y and y \u003c= y_lr and x - r \u003c= x_lr:\n        return True\n    # ③上辺にぶつかった場合\n    elif y \u003c y_ul and x_ul \u003c= x and x \u003c= x_lr and y + r \u003e= y_ul:\n        return True\n    # ④下辺にぶつかった場合\n    elif y \u003e y_lr and x_ul \u003c= x and x \u003c= x_lr and y - r \u003c= y_lr:\n        return True\n    # ⑤左上隅にぶつかった場合\n    elif x \u003c x_ul and y \u003c y_ul and (x - x_ul)**2 + (y - y_ul)**2 \u003c= r**2:\n        return True\n    # ⑥右上隅にぶつかった場合\n    elif x \u003e x_lr and y \u003c y_ul and (x - x_lr)**2 + (y - y_ul)**2 \u003c= r**2:\n        return True\n    # ⑦左下隅にぶつかった場合\n    elif x \u003c x_ul and y \u003e y_lr and (x - x_ul)**2 + (y - y_lr)**2 \u003c= r**2:\n        return True\n    # ⑧右下隅にぶつかった場合\n    elif x \u003e x_lr and y \u003e y_lr and (x - x_lr)**2 + (y - y_lr)**2 \u003c= r**2:\n        return True\n    return False","position":{"start":{"line":405,"column":1},"end":{"line":434,"column":1}},"key":"oz3ilKQI8k"},{"type":"paragraph","position":{"start":{"line":436,"column":1},"end":{"line":436,"column":1}},"children":[{"type":"text","value":"障害物は上下セットで2つ×5段階程度を配置する．最初は画面の右外に配置し，だんだん画面内に入ってくるようにする．","position":{"start":{"line":436,"column":1},"end":{"line":436,"column":1}},"key":"WpOFdGkfts"}],"key":"bPKm9UYDlt"},{"type":"paragraph","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"children":[{"type":"text","value":"以下のコードでは障害物で通り抜けられる部分の位置をランダムに決め，それより上とそれより下に障害物となる長方形が置かれるように座標を計算する．そして","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"key":"OUQCZUDWJT"},{"type":"inlineCode","value":"obstacles","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"key":"ypEP43gsKP"},{"type":"text","value":"というリストを用意し，これに障害物となる長方形を格納している．","position":{"start":{"line":438,"column":1},"end":{"line":438,"column":1}},"key":"nScS70hCXQ"}],"key":"z1efLXEbvb"},{"type":"code","lang":"python","value":"# 障害物群を作る．\nimport random\nobstacles = []\nspan_x = 200    # 障害物を置く間隔\nx_start = WIDTH + 50\nfor _ in range(5):\n    # 障害物で「空いている部分」の高さを決める．\n    hole_y = random.randint(30, HEIGHT - 90)\n    obstacles.append( [ x_start, 0, x_start + 50, hole_y] )  # 上の矩形\n    obstacles.append( [ x_start, hole_y + 80, x_start + 50, HEIGHT] )  # 下の矩形\n    x_start += span_x","position":{"start":{"line":440,"column":1},"end":{"line":452,"column":1}},"key":"Njz2QENzuD"},{"type":"paragraph","position":{"start":{"line":454,"column":1},"end":{"line":454,"column":1}},"children":[{"type":"text","value":"壁や長方形との衝突を判定する必要がある．衝突したらゲームオーバーにするので，跳ね返りを計算する必要はない．衝突したかどうかを保持する変数","position":{"start":{"line":454,"column":1},"end":{"line":454,"column":1}},"key":"jcQXWCBv9h"},{"type":"inlineCode","value":"collided","position":{"start":{"line":454,"column":1},"end":{"line":454,"column":1}},"key":"MtTLIsWzyV"},{"type":"text","value":"を用意する．","position":{"start":{"line":454,"column":1},"end":{"line":454,"column":1}},"key":"MnbAzt4fgU"}],"key":"kT5pgoVkJE"},{"type":"code","lang":"python","value":"collided = False","position":{"start":{"line":456,"column":1},"end":{"line":458,"column":1}},"key":"HQccqS5o4F"},{"type":"paragraph","position":{"start":{"line":460,"column":1},"end":{"line":460,"column":1}},"children":[{"type":"text","value":"そしてメインループの中で，壁や障害物（長方形）との衝突を判定する．障害物は複数あるので，","position":{"start":{"line":460,"column":1},"end":{"line":460,"column":1}},"key":"KWvtKsNIBR"},{"type":"inlineCode","value":"for","position":{"start":{"line":460,"column":1},"end":{"line":460,"column":1}},"key":"YsE0sDIgD2"},{"type":"text","value":"ループを使って個々の障害物との衝突を判定する．ここで先ほど作った衝突判定関数","position":{"start":{"line":460,"column":1},"end":{"line":460,"column":1}},"key":"A217QxBORn"},{"type":"inlineCode","value":"collision_test","position":{"start":{"line":460,"column":1},"end":{"line":460,"column":1}},"key":"tWRULIxvTY"},{"type":"text","value":"が使われている．","position":{"start":{"line":460,"column":1},"end":{"line":460,"column":1}},"key":"KM0OWDUlDi"}],"key":"NUd0I3hMay"},{"type":"code","lang":"python","value":"    # 4a. 壁にぶつかったら，ゲームオーバー\n    if y - r \u003c= 0 and vy \u003c 0:\n        collided = True\n    elif y + r \u003e= HEIGHT and vy \u003e 0:\n        collided = True\n    \n    # 4b. 矩形にぶつかったら，ゲームオーバー\n    for obs in obstacles:\n        x_ul, y_ul, x_lr, y_lr = obs\n        if collision_test(x, y, r, x_ul, y_ul, x_lr, y_lr):\n            collided = True\n            break","position":{"start":{"line":462,"column":1},"end":{"line":475,"column":1}},"key":"QIJdbNGIbp"},{"type":"paragraph","position":{"start":{"line":477,"column":1},"end":{"line":477,"column":1}},"children":[{"type":"text","value":"障害物は右から左にゆっくりと動かす．つまり障害物の","position":{"start":{"line":477,"column":1},"end":{"line":477,"column":1}},"key":"rU7ZgMlVyd"},{"type":"inlineMath","value":"x","position":{"start":{"line":477,"column":1},"end":{"line":477,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ex\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"apNTJZp9d2"},{"type":"text","value":"座標をだんだん小さくする．障害物が左の壁を通過したら，もういちど右側に持って行く．","position":{"start":{"line":477,"column":1},"end":{"line":477,"column":1}},"key":"MnqBHnGL0Z"}],"key":"nQ7j5SdFlQ"},{"type":"code","lang":"python","value":"        # 一番右の障害物の位置を調べる\n        max_x = 0\n        for o in obstacles:\n            if o[0] \u003e max_x:\n                max_x = o[0]\n        # 長方形を左に向かって少しずつ移動\n        for obs in obstacles:\n            obs[0] -= 0.5\n            obs[2] -= 0.5\n            # 画面外に出た障害物は，一番左にある障害物からx_span空けた位置に再配置\n            if obs[2] \u003c 0:\n                obs[0] = max_x + span_x\n                obs[2] = max_x + span_x + 50","position":{"start":{"line":479,"column":1},"end":{"line":493,"column":1}},"key":"lXAi7oLpU5"},{"type":"paragraph","position":{"start":{"line":495,"column":1},"end":{"line":495,"column":1}},"children":[{"type":"text","value":"障害物を画面に表示する機能も，忘れずにつけておく．","position":{"start":{"line":495,"column":1},"end":{"line":495,"column":1}},"key":"TKVBRpA6BW"}],"key":"AJmYW5ZxbZ"},{"type":"code","lang":"python","value":"    # 6b. 障害物を描く\n    for obs in obstacles:\n        x_ul, y_ul, x_lr, y_lr = obs\n        pygame.draw.rect(screen, (0, 0, 255), (x_ul, y_ul, x_lr - x_ul, y_lr - y_ul))","position":{"start":{"line":497,"column":1},"end":{"line":502,"column":1}},"key":"UkbjnjJsBy"},{"type":"paragraph","position":{"start":{"line":504,"column":1},"end":{"line":504,"column":1}},"children":[{"type":"text","value":"これでFlappy Bird風の障害物くぐりゲームの骨組みができた．","position":{"start":{"line":504,"column":1},"end":{"line":504,"column":1}},"key":"nrc5asseFC"}],"key":"bDyIcZ5TbZ"},{"type":"container","kind":"figure","children":[{"type":"image","url":"https://akonno.github.io/FluidSeminarMaterials//build/screenshot3-8-6dd431e554405963f4e72e30317af1ad.png","alt":"障害物くぐりゲームの画面","align":"center","data":{"altTextIsAutoGenerated":true},"key":"ZWIcwsqcBu","urlSource":"./images/media/screenshot3-8.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":510,"column":1},"end":{"line":510,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-ss3-8","identifier":"fig-ss3-8","html_id":"fig-ss3-8","enumerator":"79","children":[{"type":"text","value":"Figure ","key":"fF6neHJU96"},{"type":"text","value":"79","key":"mXwAMTyyhO"},{"type":"text","value":":","key":"kGQGIloTyq"}],"template":"Figure %s:","key":"i9Zd0gQx2N"},{"type":"text","value":"障害物くぐりゲームの画面","position":{"start":{"line":510,"column":1},"end":{"line":510,"column":1}},"key":"ibWtdaoVg5"}],"key":"NKsnvKD4pu"}],"key":"d3Mcb9kcnc"}],"label":"fig-ss3-8","identifier":"fig-ss3-8","enumerator":"79","html_id":"fig-ss3-8","key":"c2m8kJp7mU"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"演習課題","position":{"start":{"line":513,"column":1},"end":{"line":513,"column":1}},"key":"kf11UetDmH"}],"key":"JjmZXQvLFm"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":515,"column":1},"end":{"line":517,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":515,"column":1},"end":{"line":515,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"ここまで検討してきた内容に基づき，障害物くぐりゲームを作成せよ．","position":{"start":{"line":515,"column":1},"end":{"line":515,"column":1}},"key":"il0CMd1Ips"}],"key":"w8zzZpSYCL"}],"key":"exgXcT8zRn"},{"type":"listItem","spread":true,"position":{"start":{"line":516,"column":1},"end":{"line":516,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"障害物にぶつかったら，ゲームオーバーになるようにせよ．","position":{"start":{"line":516,"column":1},"end":{"line":516,"column":1}},"key":"VkfCIzBUHj"}],"key":"gRYm0vfeGt"}],"key":"j8fW1AwmAg"},{"type":"listItem","spread":true,"position":{"start":{"line":517,"column":1},"end":{"line":517,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"スコアを表示し，障害物をくぐり抜けたらスコアが加算されるようにせよ．","position":{"start":{"line":517,"column":1},"end":{"line":517,"column":1}},"key":"A5KnxsGkG7"}],"key":"iY7bdcEK4f"}],"key":"YHyZmowOkl"}],"key":"ycJqLJiN2h"}],"class":"exercise","key":"Xl4sFuDABp"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"演習課題（発展）","position":{"start":{"line":520,"column":1},"end":{"line":520,"column":1}},"key":"OL3TecDopB"}],"key":"TtcSPGPdmU"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":522,"column":1},"end":{"line":523,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":522,"column":1},"end":{"line":522,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"現在の障害物くぐりゲームでは，同じ障害物がローテーションして搭乗するが，障害物が画面の左に抜けたら穴の位置を新たに決めて，障害物を作り直すようにせよ．","position":{"start":{"line":522,"column":1},"end":{"line":522,"column":1}},"key":"JD1jtXxJda"}],"key":"sAVMTd0apb"}],"key":"ttwAZBqEde"},{"type":"listItem","spread":true,"position":{"start":{"line":523,"column":1},"end":{"line":523,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"ゲームの難易度がだんだん上がるように，障害物くぐりゲームを改変せよ．","position":{"start":{"line":523,"column":1},"end":{"line":523,"column":1}},"key":"iE4SYaei67"}],"key":"GJBsCwONLv"}],"key":"sdH6jypW9x"}],"key":"oPK8OIv0oX"}],"class":"exercise","key":"kZNHSVbhJP"},{"type":"heading","depth":2,"position":{"start":{"line":526,"column":1},"end":{"line":526,"column":1}},"children":[{"type":"text","value":"課題（LMS提出）","position":{"start":{"line":526,"column":1},"end":{"line":526,"column":1}},"key":"lb1vbAuh7C"}],"identifier":"id-lms","label":"課題（LMS提出）","html_id":"id-lms","implicit":true,"key":"O0HY3pHNOS"},{"type":"paragraph","position":{"start":{"line":528,"column":1},"end":{"line":529,"column":1}},"children":[{"type":"text","value":"以下に課題に取り組み，その成果物のソースコード，および成果物について説明するレポートを提出せよ．\n提出方法および提出期限はKU-LMSで確認せよ．","position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"key":"EXOshgnPnZ"}],"key":"ED6rJxVa7t"},{"type":"paragraph","position":{"start":{"line":531,"column":1},"end":{"line":531,"column":1}},"children":[{"type":"text","value":"レポートには以下の内容を含めること．","position":{"start":{"line":531,"column":1},"end":{"line":531,"column":1}},"key":"FwRGWDmmuc"}],"key":"S88WSNlt0G"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":532,"column":1},"end":{"line":536,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"作品の概要（ゲームのルールや目的）","position":{"start":{"line":532,"column":1},"end":{"line":532,"column":1}},"key":"klh5VXBz9Z"}],"key":"lXt3leWjD0"}],"key":"BzXwmcZK9n"},{"type":"listItem","spread":true,"position":{"start":{"line":533,"column":1},"end":{"line":533,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"操作方法および実行方法（使用ファイル、実行コマンド）","position":{"start":{"line":533,"column":1},"end":{"line":533,"column":1}},"key":"fKPo4rt8aD"}],"key":"Gea5dDi32q"}],"key":"vlgaDPkbIk"},{"type":"listItem","spread":true,"position":{"start":{"line":534,"column":1},"end":{"line":534,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"工夫した点・発展項目（課題2の場合）","position":{"start":{"line":534,"column":1},"end":{"line":534,"column":1}},"key":"HibBth7KrT"}],"key":"Y8OfiFDvrh"}],"key":"JEUgfYBpBW"},{"type":"listItem","spread":true,"position":{"start":{"line":535,"column":1},"end":{"line":536,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"実行中のスクリーンショット","position":{"start":{"line":535,"column":1},"end":{"line":535,"column":1}},"key":"j2RHAelXP7"}],"key":"qQR31xBwvx"}],"key":"VTHAHvDw7L"}],"key":"qxaIOlv4r8"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"課題1：最小のテニスゲーム（基礎）","position":{"start":{"line":537,"column":1},"end":{"line":537,"column":1}},"key":"W3spFESouQ"}],"key":"DLefwhJbSX"},{"type":"paragraph","position":{"start":{"line":539,"column":1},"end":{"line":540,"column":1}},"children":[{"type":"text","value":"「壁で跳ね返るボールのアニメーション」を改造し、\nマウスで動くラケットでボールを打ち返すテニス風ゲームを作成せよ。","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"key":"ldLYN8vqrc"}],"key":"HnVJbYBNkt"},{"type":"paragraph","position":{"start":{"line":542,"column":1},"end":{"line":542,"column":1}},"children":[{"type":"text","value":"必須条件：","position":{"start":{"line":542,"column":1},"end":{"line":542,"column":1}},"key":"Fx0piljE9g"}],"key":"h4bvjryEoO"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":543,"column":1},"end":{"line":546,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":543,"column":1},"end":{"line":543,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"重力は使わず（ax = ay = 0）、ボールは直線運動とする。","position":{"start":{"line":543,"column":1},"end":{"line":543,"column":1}},"key":"tEGRwPZSGV"}],"key":"ktDKZV916F"}],"key":"OX3MxhzmdC"},{"type":"listItem","spread":true,"position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"ラケット（長方形）に当たるとボールが左向きに跳ね返る。","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"key":"W56HOuuKfo"}],"key":"X7i7NomBi8"}],"key":"ISr7wHHv1T"},{"type":"listItem","spread":true,"position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"ボールが左の壁に当たったら 1 点加算する。","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"key":"CC8liRg2RH"}],"key":"URtGS5zdA6"}],"key":"MHlgZtqSZF"},{"type":"listItem","spread":true,"position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"ボールが右の壁に当たったらゲームオーバーとする。","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"key":"veXhJY7jVO"}],"key":"dsaKexoDv8"}],"key":"V8kYv1uCdo"}],"key":"LDSIImSvKp"}],"class":"assignment","key":"smofxRBt9z"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"課題2：応用ゲーム（発展）","position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"key":"bG48TWmoVG"}],"key":"Q8x5OnTQOl"},{"type":"paragraph","position":{"start":{"line":551,"column":1},"end":{"line":552,"column":1}},"children":[{"type":"text","value":"課題1を発展させ、オリジナルのゲームまたはインタラクティブ作品を作成せよ。\n以下のような例を参考にしてよいが、教材で示したコードをそのまま提出することは不可とする。","position":{"start":{"line":551,"column":1},"end":{"line":551,"column":1}},"key":"Y7kDMEUP7u"}],"key":"e8Sg4HIBaK"},{"type":"paragraph","position":{"start":{"line":554,"column":1},"end":{"line":554,"column":1}},"children":[{"type":"text","value":"例：","position":{"start":{"line":554,"column":1},"end":{"line":554,"column":1}},"key":"txxKRL3ZLH"}],"key":"HwfDPsDpmJ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":555,"column":1},"end":{"line":559,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":555,"column":1},"end":{"line":555,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"ブロック崩し","position":{"start":{"line":555,"column":1},"end":{"line":555,"column":1}},"key":"ubkFFPYgpM"}],"key":"IJePUzZkr9"}],"key":"qMLy9BuU40"},{"type":"listItem","spread":true,"position":{"start":{"line":556,"column":1},"end":{"line":556,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"エアホッケー","position":{"start":{"line":556,"column":1},"end":{"line":556,"column":1}},"key":"ce4oyCmyF8"}],"key":"ovsEChVG8I"}],"key":"Ce9gkVtjRY"},{"type":"listItem","spread":true,"position":{"start":{"line":557,"column":1},"end":{"line":557,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"インタラクティブアート（軌跡・色・音など）","position":{"start":{"line":557,"column":1},"end":{"line":557,"column":1}},"key":"US7E2NrT10"}],"key":"AAImgtRHRZ"}],"key":"WTkjKOOiij"},{"type":"listItem","spread":true,"position":{"start":{"line":558,"column":1},"end":{"line":559,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"障害物くぐりゲーム（Flappy Bird風）","position":{"start":{"line":558,"column":1},"end":{"line":558,"column":1}},"key":"fGJOcAj5Bg"},{"type":"strong","position":{"start":{"line":558,"column":1},"end":{"line":558,"column":1}},"children":[{"type":"text","value":"※ただし必ず以下のいずれかを実装すること","position":{"start":{"line":558,"column":1},"end":{"line":558,"column":1}},"key":"abZb6GNCoF"}],"key":"giwCi9qYND"}],"key":"ziqBQjbjYI"}],"key":"ZLUw7l8LUO"}],"key":"wZ2uaw6sKi"},{"type":"paragraph","position":{"start":{"line":560,"column":1},"end":{"line":560,"column":1}},"children":[{"type":"text","value":"障害物くぐりゲーム（Flappy Bird風）を選ぶ場合の必須追加条件：以下のいずれかの機能を導入すること．","position":{"start":{"line":560,"column":1},"end":{"line":560,"column":1}},"key":"MBvXRKNMi8"}],"key":"x8Z7v0H0NF"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":561,"column":1},"end":{"line":566,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":561,"column":1},"end":{"line":561,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"障害物の速度が時間経過で変化する（速くなる／遅くなる）","position":{"start":{"line":561,"column":1},"end":{"line":561,"column":1}},"key":"rDvmqeAiNz"}],"key":"tpOMoPIWZI"}],"key":"KP3jTI4tOu"},{"type":"listItem","spread":true,"position":{"start":{"line":562,"column":1},"end":{"line":562,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"障害物の幅や隙間の大きさが変化する（難易度調整）","position":{"start":{"line":562,"column":1},"end":{"line":562,"column":1}},"key":"sNPxrzRHDn"}],"key":"bmJIhhh0yn"}],"key":"pRzZod1NI8"},{"type":"listItem","spread":true,"position":{"start":{"line":563,"column":1},"end":{"line":563,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"障害物が上下に動く（往復運動など）","position":{"start":{"line":563,"column":1},"end":{"line":563,"column":1}},"key":"qwQ21wROgy"}],"key":"pqDbXayEaF"}],"key":"IF1ulGaUcv"},{"type":"listItem","spread":true,"position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"背景スクロール、パーティクル、効果音など視覚・聴覚演出を追加","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"key":"HUFNQoSfRu"}],"key":"lYdVAcRUSn"}],"key":"QVDsphhlr2"},{"type":"listItem","spread":true,"position":{"start":{"line":565,"column":1},"end":{"line":565,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"ゲームオーバー画面、タイトル画面、リトライ機能をつける","position":{"start":{"line":565,"column":1},"end":{"line":565,"column":1}},"key":"zFAjErEP8w"}],"key":"Ckm7XOq8CA"}],"key":"s4C0PiU3xt"},{"type":"listItem","spread":true,"position":{"start":{"line":566,"column":1},"end":{"line":566,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"ステージ制（一定スコアで次の難易度へ）を導入","position":{"start":{"line":566,"column":1},"end":{"line":566,"column":1}},"key":"gshDYuSpnq"}],"key":"jTa4v59iMX"}],"key":"yS3MvW219c"}],"key":"xx1K1Cr6dB"}],"class":"assignment","key":"BetogFwHSi"},{"type":"heading","depth":2,"position":{"start":{"line":569,"column":1},"end":{"line":569,"column":1}},"children":[{"type":"text","value":"ライセンス","position":{"start":{"line":569,"column":1},"end":{"line":569,"column":1}},"key":"JbeLy50a1Z"}],"identifier":"id","label":"ライセンス","html_id":"id-8","implicit":true,"key":"misEg0RIwI"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"tA42TSEHts"}],"key":"s7u6eqG9vO"},{"type":"paragraph","position":{"start":{"line":572,"column":1},"end":{"line":575,"column":1}},"children":[{"type":"text","value":"このページの本文と図版は CC BY-NC-SA 4.0 とします。","position":{"start":{"line":572,"column":1},"end":{"line":572,"column":1}},"key":"WZS5PE5dqw"},{"type":"break","position":{"start":{"line":572,"column":1},"end":{"line":572,"column":1}},"key":"m4acYAXyS8"},{"type":"text","value":"サンプルコードは MIT License とします。","position":{"start":{"line":572,"column":1},"end":{"line":572,"column":1}},"key":"aiCeK4Xpxv"},{"type":"break","position":{"start":{"line":572,"column":1},"end":{"line":572,"column":1}},"key":"MHCYBbZCw4"},{"type":"text","value":"一部の学生作品のスクリーンショットなどはこの限りではありません。","position":{"start":{"line":572,"column":1},"end":{"line":572,"column":1}},"key":"yDxMmyZkAC"},{"type":"break","position":{"start":{"line":572,"column":1},"end":{"line":572,"column":1}},"key":"BlR1g6Wgyn"},{"type":"text","value":"提出物（あなた自身のコードやスクリーンショット）は，ポートフォリオや就職活動で自由に使ってよいものとします。","position":{"start":{"line":572,"column":1},"end":{"line":572,"column":1}},"key":"QjlVYLt4Iy"}],"key":"RR9rpeQJKq"}],"key":"ufqjrP9gVe"}],"key":"VqNbEmpaqV"}],"key":"mdXt6HZwLq"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"PyGame-CEによるインタラクティブ表現入門その2：PyGame-CEの基本とアニメーション","url":"/pygame2","group":"流体工学セミナー・教材集"}}},"domain":"http://localhost:3000"},"project":{"numbering":{"figure":{"enabled":true,"continue":true}},"title":"流体工学セミナー・教材集","toc":[{"file":"intro.md"},{"file":"miniforge.md"},{"file":"jupyterlab.md"},{"file":"kodingbasics.md"},{"file":"pygame1.md"},{"file":"pygame2.md"},{"file":"pygame3.md"}],"exports":[],"bibliography":[],"index":"index","pages":[{"slug":"miniforge","title":"MiniforgeではじめるPythonプログラミング","description":"","date":"","thumbnail":"https://akonno.github.io/FluidSeminarMaterials//build/image1-1e6971224340eba935a45f2a25ce2604.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"jupyterlab","title":"JupyterLabの導入","description":"","date":"","thumbnail":"https://akonno.github.io/FluidSeminarMaterials//build/jupyterlab01en-6395564036092c7a9e2ecb3c0798f24c.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"kodingbasics","title":"KodingBasicsでプログラミング課題に挑戦","description":"","date":"","thumbnail":"https://akonno.github.io/FluidSeminarMaterials//build/kodingbasics-toppage-1c318d62c5988c14b4b4771f3fff5b8b.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"pygame1","title":"PyGame-CEによるインタラクティブ表現入門その1：PyGame-CEのインストールと実行","description":"","date":"","thumbnail":"https://akonno.github.io/FluidSeminarMaterials//build/editor01.drawio-e4be0ff2071909da362d6e010732f4c6.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"pygame2","title":"PyGame-CEによるインタラクティブ表現入門その2：PyGame-CEの基本とアニメーション","description":"","date":"","thumbnail":"https://akonno.github.io/FluidSeminarMaterials//build/screenshot2-1-d2f378fdb795ed11ec8865506d50ab92.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"pygame3","title":"PyGame-CEによるインタラクティブ表現入門その3：動きと衝突の基礎とゲームへの応用","description":"","date":"","thumbnail":"https://akonno.github.io/FluidSeminarMaterials//build/screenshot3-1-8a46c52397cdd4dcc91823ee7249635e.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "https://akonno.github.io/FluidSeminarMaterials//build/manifest-3481E987.js";
import * as route0 from "https://akonno.github.io/FluidSeminarMaterials//build/root-7TUVC4ZT.js";
import * as route1 from "https://akonno.github.io/FluidSeminarMaterials//build/routes/$-P6PGXPYX.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("https://akonno.github.io/FluidSeminarMaterials//build/entry.client-UNPC4GT3.js");</script></body></html>